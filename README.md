# **UniHelm YAML v1.0**
> **Universal HELM in YAML form** — A human‑readable, extensible format for defining polymerizable chemical building blocks with torsional topology metadata.

---

## **Overview**
**UniHelm** is a **YAML-based schema** for defining reusable molecular building blocks (monomers) for:

- **Proteins** *(PEPTIDE)*
- **DNA / RNA** *(DNA / RNA)*
- **Small molecules** *(CHEM)*
- **Polyketides** *(POLYKETIDE)*
- **Carbohydrates** *(CARBOHYDRATE)*
- **Solvents / Ligands / Cofactors*

It extends the conceptual model of **HELM** to:
- Be **human-readable/editable**
- Store **rotamer/topology-relevant geometry data**
- Work for **all molecule classes**, not just biopolymers
- Support **default/autogenerated fields** for simplicity

---

## **Key Concepts**
Each **UniHelm YAML file** defines:
- **Header** identifying the format and version
- **SMILES** describing connectivity
- **Optional atom naming** (auto-generated if omitted)
- **Polymer connection points** (ports)
- **Geometry overrides** for bond lengths, angles, torsions
- **Rigid group definitions** for efficient torsion-based modeling
- **Special torsions** linking to rotamer libraries

From a set of UniHelm monomers, you can:
- Assemble polymers (proteins, nucleic acids, polyketides, etc.)
- Generate **torsion topology** and **idealized coordinates**
- Integrate **rotamer-based sampling** into modeling workflows
- Export to **HELM, MOL/SDF, PDB** as needed

---

## **Repository Layout**
```
unihelm/
    monomers/
        PEPTIDE/
            ALA.yaml
            PRO.yaml
            TYR.yaml
        RNA/
            A.yaml
        CHEM/
            HEM.yaml
            HOH.yaml
        POLYKETIDE/
            PK-UNIT1.yaml
    schema/
        unihelm_v1_schema.json   # JSON Schema for UniHelm YAML validation
    tools/
        unihelm_validator.py     # Python RDKit-based validator
    README.md
```

---

## **Example: ALA.yaml**
```yaml
format: UniHelm YAML
version: 1.0
monomer_id: ALA
polymer_type: PEPTIDE
category: amino_acid
natural_analog: A
smiles: "N[C@@H](C)C(=O)O"

atom_names:
  0: N
  1: CA
  2: CB
  3: C
  4: O
  5: OXT
  6: HN
  7: HB1
  8: HB2
  9: HB3
  10: HA

connections:
  - id: R1
    label: N_terminal
    connect_atom: N
    remove_atoms_on_connect: [HN]
    order: 1
    type: Polymer
  - id: R2
    label: C_terminal
    connect_atom: C
    remove_atoms_on_connect: [OXT]
    order: 1
    type: Polymer

geometry:
  bonds:
    - { atoms: [N, CA], length: 1.458 }
    - { atoms: [CA, C], length: 1.525 }
    - { atoms: [C, O], length: 1.229 }
  angles:
    - { atoms: [C_prev, N, CA], angle: 121.7 }
    - { atoms: [N, CA, C], angle: 111.2 }
rigid_groups:
  - id: backbone
    atoms: [N, CA, C, O, HN, HA]
  - id: sidechain
    atoms: [CB, HB1, HB2, HB3]
special_torsions:
  - name: chi1
    atoms: [N, CA, CB, HB1]
    library_key: "C(sp3)-C(sp3)-C(sp3)-X"
```

---

## **Required Fields**
Every **UniHelm YAML** must contain:
- `format`: `"UniHelm YAML"`
- `version`: `"1.0"`
- `monomer_id`: Symbolic ID (ALA, TYR, DA, etc.)
- `polymer_type`: One of:
  - `PEPTIDE`
  - `RNA`
  - `DNA`
  - `CHEM`
  - `POLYKETIDE`
  - `CARBOHYDRATE`
- `smiles`: Valid SMILES string

---

## **Optional Fields and Defaults**
| Field             | Default          | Notes |
|-------------------|------------------|-------|
| `atom_names`      | `auto-generate`  | Auto from SMILES if omitted |
| `geometry`        | `auto-generate`  | From default parameter library unless overridden |
| `connections`     | `None`           | Required for polymerizable units |
| `rigid_groups`    | `auto-detect`    | Aromatics, rings detected automatically |
| `special_torsions`| `None`           | Only if linking to rotamer library/discrete DOFs |

---

## **Validation**
We include an RDKit-based validator for syntax and consistency checking.

### **Run validator**
```bash
python tools/unihelm_validator.py monomers/
```

**Checks performed:**
1. **Schema integrity** (format, version, required keys)
2. **SMILES parseability** via RDKit
3. Atom references in geometry/connections/rigid_groups
4. Connection semantics for polymer types
5. Warnings for missing/extra polymer connection points

---

## **How to Add a New Monomer**
1. Copy an existing YAML in the right `polymer_type` folder
2. Update:
   - `monomer_id`
   - `smiles`
   - Atom naming (if needed)
   - Connections (if polymerizable)
   - Geometry/rigid_groups (if biomolecule)
3. Run:
```bash
python tools/unihelm_validator.py monomers/PEPTIDE/NEW_MONOMER.yaml
```
4. Commit & push.

---

## **Planned Features**
- Rotamer library integration (special torsions → discrete values)
- Automatic geometry generation from parameter sets
- HELM export/import
- Direct coordinate builder from UniHelm YAML

---

## **License**
[MIT License](LICENSE)

---

## **Authors**
This format and library are being developed to replace HELM’s JSON-based monomer format with a **human-friendly, universal alternative** designed for **rotamer/topology-driven modeling** across **proteins, nucleic acids, small molecules, and more**.

