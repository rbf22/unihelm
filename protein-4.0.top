remark  File toppar/protein-4.0.top 
remark      Xplor-NIH version of CNS protein-allhdg5-4.top (14-DEC-2022)
remark
remarks file toppar/protein-allhdg5-4.top
remarks
remarks   file topallhdg.pro  version 5.4  date 07-July-10
remarks      for file parallhdg.pro version 5.4 date 07-July-10 or later
remarks   Geometric energy function parameters for distance geometry and
remarks      simulated annealing.
remarks   Author: Michael Nilges, EMBL Heidelberg; Institut Pasteur, Paris
remarks   This file contains modifications from M. Williams, UCL London
remarks   and multiple modifications for HADDOCK from A. Bonvin, Utrecht University
!remarks   Last modification 10-01-2012 



set messages off echo off end


!***********************************************************************!
! Copyright (C) 1995,1996 by Michael Nilges. All rights reserved.       !
! Copying and redistribution of this files is authorized only if etiher !
! (1) you make absolutely no changes to your copy, including name, or   !
! (2) if you do make changes, you name it something other than          !
! topallhdg.pro and topallhdg.x.xx.pro, and clearly mark the changes.   ! 
! The information in this software is subject to change without notice  !
! and should not be construed as a commitment by the EMBL or by the     !
! authors. Neither the EMBL, Yale University, nor the authors assume    !
! responsibility for the use or reliability of this software.           !
! We do hope, however, to get responses from users, especially when     !
! errors have been found.                                               !
!***********************************************************************!
! Description:                                                          !
! This parameter file was originally derived from the  CHARMM parameter !
! file PARMALLH6. It was designed specifically for the initial stages   ! 
! of calculating structures from NMR restraints.                        !
!***********************************************************************!
! TO DO:
! * Add missing chirality impropers for residues MLZ, MLY, M3L.
! * Add missing parameters to rehabilitate residue CHX.
! * LYR residue: Add impropers to enforce planarity accross double bonds.
! * Make all HIS ring protons aromatic? None of them?
! * TYS (PTR) has S (P) chirality improper commented out.
! * Treat CIAP sidechain peptide impropers as backbone.
!
!
! History:
! Xplor-NIH v4.0 (20-JAN-2023) : added "!DIHE_" before each (ADD/DELE) DIHE statements to help enable
!                                /disable dihedrals via protocol.initTopology and psfGen.seqToPSF [G.A.Bermejo].
! Xplor-NIH v4.0 ( 6-JAN-2023) : commented out ARG impropers in excess over protein-3.1.top [G.A.Bermejo].
! Xplor-NIH v4.0 ( 6-JAN-2023) : made ALY planar NZ improper as backbone peptide [G.A.Bermejo].  
! Xplor-NIH v4.0 (15-DEC-2022) : added !LINK comments to help generate sequence topology
!                                by psfGen.seqToPSF [G.A.Bermejo].
! Xplor-NIH v4.0 ( 1-JUN-2018) : added residues LYR and AIB [G.A.Bermejo].
! Xplor-NIH v4.0 (24-MAY-2018) : replaced residue CYM by CYSP [G.A.Bermejo].
! Xplor-NIH v4.0 (23-MAY-2018) : added residue CIAP [G.A.Bermejo].
! Xplor-NIH v4.0 (27-APR-2018) : aromatic protons given new HAR type [G.A.Bermejo].
! Xplor-NIH v4.0 (19-APR-2018) : added patch CLYS (adapted from protein-3.2.top) [G.A.Bermejo].
! Xplor-NIH v4.0 (18-APR-2018) : commented out residue CHX (missing parameters) [G.A.Bermejo].
! Xplor-NIH v4.0 (26-MAY-2017) : added PACE patch for ACE-* link (albeit harmless, PEPT  
!                                patch yields error messages about missing dihedrals) [G.A.Bermejo].
! Xplor-NIH v4.0 (25-MAY-2017) : added singly protonated versions of HIS as residues
!                                (HISD and HISE; adapted from the patches) [G.A.Bermejo].
! Xplor-NIH v4.0 (25-MAY-2017) : renamed residues ASH->ASPH and GLH->GLUH [G.A.Bermejo].            
! Xplor-NIH v4.0 (24-MAY-2017) : renamed residue TOP as TPO [G.A.Bermejo].
! Xplor-NIH v4.0 (23-MAY-2017) : added OPT type (removed OP1, OR3) to fix conflicting 
!                                parameters in phosphorylated residues PTR, NEP, CSP  
!                                (did same for residues SEP and TOP) [G.A.Bermejo].
! Xplor-NIH v4.0 (12-MAY-2017) : removed residue TYP (same as PTR) [G.A.Bermejo].
! Xplor-NIH v4.0 (11-MAY-2017) : assigned new type to N in N-ter PRO (PROP patch)
!                                to fix conflicting parameters [G.A.Bermejo].
! Xplor-NIH v4.0 (28-APR-2017) : commented DELE DONO statement in patches HISD and HISE
!                                to avoid (inexplicable) error messages [G.A.Bermejo].
! Xplor-NIH v4.0 (30-MAR-2017) : assigned new atom type in residue MLZ to 
!                                remove bond value duplication [G.A.Bermejo].
!
! CNS v1.3, revision 7, 1-10-2012, added improper NE2 CE1 CD2 HE2 for HIS residue
! CNS V1.3, revision 7, 11-08-2011, changed changes in CYF residue for CB and SG
! CNS v1.3, revision 6, 8-19-2011, added MSE residue
! CNS v1.3, revision 2, 12-Aug-10, modified impropers to maintain Arg planarity, 
!                                  proper stereochemical NH1, NH2 assignments without 
!                                  causing singularities.
! CNS v1.3 (27-Feb-10): changed OT1, OT2 to O, OXT, respectively
! version 5.3  (13-Feb-02) : merged UCL version with EMBL version
! version UCL  (07-JUL-01) : added new MULT disulphide/sidechain COO dihedral parameters
! version UCL  (03-JUL-01) : added new MULT phi/psi dihedral related parameters
! version UCL  (14-MAR-00) : modified peptide bond parameters for flexible omega
! version UCL  (12-MAR-00) : added C and N terminus and disulphide dihedrals
! version UCL  (09-MAR-00) : TYR O-H planarity & LYS NH3 stagger 
!                            & HIS dihedrals modified
! version 5.2  (18-Jun-99) : new cis peptide patch
! version 4.03 (04-APR-99) : THR CB atom type corrected
! version 4.02 (17-DEC-97) : Histidine hbond acceptor/donor corrected
! version 4.01 (29-Jul-96) : all covalent parameters
! version 4.00  (19-Jul-96) : all atom types from CSDX implemented
! version 3.00 (24-Oct-95) : mapped CSDX parmameters on parallhdg, 
!                            no changes in topallhdg
! previous modifications:
! proline residue modified, puckering enforced (MN)
! added hbond acceptor and donor definitions for analysis (MN)
! all references to internal coordinates (IC's) removed (MN) 
! added stereospecific impropers for all pro-chiral centers (ATB, JK)
! all dihedrals defining planarity converted to impropers (MN, PK)
! additional impropers at planar centers (MN)
!***********************************************************************!


eval ($protein_top_vers="4.0")


autogenerate 
  angles=true
  dihedrals=false
end

mass H    1.008
mass HC   1.008
mass HA   1.008
mass HAR  1.008  ! aromatic H
mass C   12.011
mass CCIS  12.011
mass CH1E  12.011
mass CH2E  12.011
mass CH3E  12.011
mass CH2G  12.011
mass CH1P  12.011
mass CH2P  12.011
mass C5W  12.011
mass CW  12.011

mass CR1E  12.011
mass C5  12.011
mass CRH  12.011
mass CR1H  12.011
mass CR1W  12.011
mass CRHH  12.011
mass CF  12.011
mass CY  12.011
mass CY2 12.011
mass N   14.007
mass NR  14.007
mass NH1 14.007
mass NH2 14.007
mass NH3 14.007
mass NP3 14.007 ! N of N-ter PRO/HYP
mass NCM 14.007 !nitrogen of MLZ
mass NC2 14.007
mass NC3 14.007
mass NC4 14.007
mass O   15.999
mass OPT 15.999 ! phosphate O in phosphorilated residues
mass OC  15.999
mass OH1 15.999
mass OHP 15.999
mass OUF 15.999
mass PP  30.97400
mass SH1E  32.060
mass SM  32.060
mass S   32.060
mass SUF 32.060
MASS   SE    78.96000! selenium (for MSE)


!----------------------------------------------------------------------

residue ALA
  group
    atom N   type=NH1     charge=-0.570 end
    atom HN  type=H       charge= 0.370 end
  group
    atom CA  type=CH1E    charge= 0.200 end
    atom HA  type=HA      charge= 0.000 end
  group
    atom CB  type=CH3E    charge= 0.000 end
    atom HB1 type=HA      charge= 0.000 end
    atom HB2 type=HA      charge= 0.000 end
    atom HB3 type=HA      charge= 0.000 end
  group
    atom C   type=C       charge= 0.500 end
    atom O   type=O       charge=-0.500 end

  bond N  HN       
  bond N  CA    bond CA  HA   
  bond CA  CB   bond CB  HB1   bond CB  HB2     bond CB  HB3
  bond CA  C       
  bond C   O

  improper HA  N   C   CB  ! chirality CA
  improper HB1 HB2 CA HB3  ! methyl CB

  !DIHE_ dihedral HB1 CB  CA  C   ! methyl stagger UCL 12-MAR-00 

  DONO HN   N
  ACCE O    C
end
 
!----------------------------------------------------------------------

residue ARG
  group
    atom N    type=NH1    charge=-0.570 end
    atom HN   type=H      charge= 0.370 end
  group
    atom CA   type=CH1E   charge= 0.200 end
    atom HA   type=HA     charge= 0.000 end
  group
    atom CB   type=CH2E   charge= 0.000 end
    atom HB1  type=HA     charge= 0.000 end
    atom HB2  type=HA     charge= 0.000 end
  group
    atom CG   type=CH2E   charge= 0.070 end
    atom HG1  type=HA     charge= 0.000 end
    atom HG2  type=HA     charge= 0.000 end
  group
    atom CD   type=CH2E   charge= 0.310 end
    atom HD1  type=HA     charge= 0.000 end
    atom HD2  type=HA     charge= 0.000 end
  group
    atom NE   type=NH1    charge=-0.700 end
    atom HE   type=H      charge= 0.440 end
  group
    atom CZ   type=C      charge= 0.640 end
  group
    atom NH1  type=NC2    charge=-0.800 end
    atom HH11 type=HC     charge= 0.460 end
    atom HH12 type=HC     charge= 0.460 end
  group
    atom NH2   type=NC2   charge=-0.800 end
    atom HH21  type=HC    charge= 0.460 end
    atom HH22  type=HC    charge= 0.460 end
  group
    atom C     type=C     charge= 0.500 end
    atom O     type=O     charge=-0.500 end
 
  bond N  HN
  bond N  CA     bond CA  HA
  bond CA CB     bond CB  HB1     bond CB  HB2
  bond CB CG     bond CG  HG1     bond CG  HG2
  bond CG CD     bond CD  HD1     bond CD  HD2
  bond CD NE     bond NE  HE
  bond NE CZ
  bond CZ NH1    bond NH1 HH11    bond NH1 HH12
  bond CZ NH2    bond NH2 HH21    bond NH2 HH22
  bond CA C
  bond C  O

  improper HA  N  C    CB  !chirality CA
  improper NE  CD CZ   HE  ! planar NE!!!

! modified impropers for Arg planarity to reduce chances of reaching singularity, ATB 8/12/10
! improper CZ  NE NH1  NH2
  improper CZ   NH1  NH2  NE !planar CZ

  improper NH1 CZ HH11 HH12  ! planar NH1
  improper NH2 CZ HH21 HH22  ! planar NH2
  improper NE  CZ NH1  HH11  
  improper NE  CZ NH2  HH21

! modified impropers for Arg planarity to reduce chances of reaching singularity, ATB 8/12/10
!!  improper CZ  NH2 HE NE  ! planar CZ ! commented out and replaced with improper that does not involve a hydrogen
  improper CD   NE   CZ   NH1 ! note: this one is defined as a dihedral in the protein.top file

!! Paragraph commented (GAB 6-JAN-2023)
!! added impropers for Arg planarity to reduce chances of reaching singularity, ATB 8/12/10
!!  improper NE   CZ   NH1  HH11 !note: one improper for each hydrogen ! these are defined as dihedrals in the protein.top file
!!  improper NE   CZ   NH2  HH21 !
!!  improper NE   CZ   NH1  HH12 !
!!  improper NE   CZ   NH2  HH22 !


  improper HB1 HB2 CA CG  !stereo CB
  improper HG1 HG2 CB CD  !stereo CG
  improper HD1 HD2 CG NE  !stereo CD

  
  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral CD  CG  CB  CA
  !DIHE_ dihedral NE  CD  CG  CB
  !DIHE_ dihedral CZ  NE  CD  CG
  
  DONO HN   N
  DONO HE   NE
  DONO HH11 NH1
  DONO HH12 NH1
  DONO HH21 NH2
  DONO HH22 NH2
  ACCE O    C
end

!----------------------------------------------------------------------

residue ASN
  group
    atom N    type=NH1    charge=-0.570 end
    atom HN   type=H      charge= 0.370 end
  group
    atom CA   type=CH1E   charge= 0.200 end
    atom HA   type=HA     charge= 0.000 end
  group
    atom CB   type=CH2E   charge=-0.000 end
    atom HB1  type=HA     charge= 0.000 end
    atom HB2  type=HA     charge= 0.000 end
  group
    atom CG   type=C      charge= 0.500 end
    atom OD1  type=O      charge=-0.500 end
  group
    atom ND2  type=NH2    charge=-0.850 end
    atom HD21 type=H      charge= 0.425 end
    atom HD22 type=H      charge= 0.425 end
  group
    atom C    type=C      charge= 0.500 end
    atom O    type=O      charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA  HA
  bond CA CB     bond CB  HB1     bond CB  HB2
  bond CB CG
  bond CG OD1
  bond CG ND2    bond ND2 HD21    bond ND2 HD22
  bond CA C
  bond C  O

  improper HA  N  C    CB  ! chirality CA
  improper CG  CB OD1  ND2  ! planar CG
  improper ND2 CG HD21 HD22 ! planar ND2
  improper CB  CG ND2  HD21
  improper HB1 HB2 CA CG  ! stereo CB

  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral OD1 CG  CB  CA ! mult 2 ! UCL

  DONO HN   N
  DONO HD21 ND2
  DONO HD22 ND2
  ACCE OD1  CG
  ACCE O    C
end

!----------------------------------------------------------------------

residue ASP
  group
    atom N   type=NH1   charge=-0.570 end
    atom HN  type=H     charge= 0.370 end
  group
    atom CA  type=CH1E  charge= 0.200 end
    atom HA  type=HA    charge= 0.000 end
  group
    atom CB  type=CH2E  charge=-0.100 end
    atom HB1 type=HA    charge= 0.000 end
    atom HB2 type=HA    charge= 0.000 end
  group
    atom CG  type=C     charge= 0.700 end
    atom OD1 type=OC    charge=-0.800 end
    atom OD2 type=OC    charge=-0.800 end
  group
    atom C   type=C     charge= 0.500 end
    atom O   type=O     charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG
  bond CG OD1
  bond CG OD2
  bond CA C
  bond C  O

  improper HA N  C   CB   !chirality CA
  improper CG CB OD1 OD2  ! planar CG
  improper HB1 HB2 CA CG  !stereo CB

  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral OD1 CG  CB  CA

  DONO HN   N
  ACCE OD1  CG
  ACCE OD2  CG
  ACCE O    C
end

!----------------------------------------------------------------------

residue ASPH  ! Protonated ASP
  group
    atom N   type=NH1   charge=-0.570 end
    atom HN  type=H     charge= 0.370 end
  group
    atom CA  type=CH1E  charge= 0.200 end
    atom HA  type=HA    charge= 0.000 end
  group
    atom CB  type=CH2E  charge= 0.000 end
    atom HB1 type=HA    charge= 0.000 end
    atom HB2 type=HA    charge= 0.000 end
  group
    atom CG  type=C     charge= 0.500 end
    atom OD1 type=OC    charge=-0.500 end
    atom OD2 type=OH1   charge=-0.450 end
    atom HD2 type=H     charge= 0.450 end
  group
    atom C   type=C     charge= 0.500 end
    atom O   type=O     charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG
  bond CG OD1
  bond CG OD2    bond OD2 HD2
  bond CA C
  bond C  O

  improper HA N  C   CB   !chirality CA
  improper CG CB OD1 OD2
  improper HB1 HB2 CA CG  !stereo CB

  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral OD1 CG  CB  CA

  DONO HN   N
  DONO HD2  OD2
  ACCE OD1  CG
  ACCE OD2  CG
  ACCE O    C
end

!----------------------------------------------------------------------

residue CSP  ! S-phosphocysteine
  group
    atom N   type=NH1    charge=-0.570 end
    atom HN  type=H      charge= 0.370 end
  group
    atom CA  type=CH1E   charge= 0.200 end
    atom HA  type=HA     charge= 0.000 end
  group
    atom CB  type=CH2E   charge= 0.080 end
    atom HB1 type=HA     charge= 0.000 end
    atom HB2 type=HA     charge= 0.000 end
  group
    atom SG  type=SM     charge=-0.440 end
    atom P   type=PP     charge= 0.520 end
    atom O1P type=OPT    charge=-0.720 end
    atom O2P type=OPT    charge=-0.720 end
    atom O3P type=OPT    charge=-0.720 end
  group
    atom C   type=C      charge= 0.500 end
    atom O   type=O      charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB SG     bond SG P 
  bond P   O1P
  bond P   O2P
  bond P   O3P
  bond CA C
  bond C  O

  improper HA N C CB   !chirality CA
  improper HB1 HB2 CA SG  !stereo CB
  !improper SG  P O3P O1P 

  !DIHE_ dihedral SG  CB  CA  N
  !DIHE_ dihedral CB  SG  P   O3P  ! phosphate stagger

  DONO HN   N
  ACCE O    C
  ACCE O1P  P
  ACCE O2P  P
  ACCE O3P  P

end

!----------------------------------------------------------------------

residue CYF  ! cysteine without HG
  group
    atom N   type=NH1    charge=-0.570 end
    atom HN  type=H      charge= 0.370 end
  group
    atom CA  type=CH1E   charge= 0.200 end
    atom HA  type=HA     charge= 0.000 end
  group
    atom CB  type=CH2E   charge=-0.020 end ! charged AB for better Zn coordination
    atom HB1 type=HA     charge= 0.000 end
    atom HB2 type=HA     charge= 0.000 end
  group
    atom SG  type=SH1E   charge=-0.720 end ! charged AB for better Zn coordination
  group
    atom C   type=C      charge= 0.500 end
    atom O   type=O      charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB SG
  bond CA C
  bond C  O

  improper HA N C CB   !chirality CA
  improper HB1 HB2 CA SG  !stereo CB

  !DIHE_ dihedral SG  CB  CA  N

  DONO HN   N
  !!! ACCE SG    !REMOVED, ATB
  ACCE O    C
end

!----------------------------------------------------------------------

residue CYS
  group
    atom N   type=NH1    charge=-0.570 end
    atom HN  type=H      charge= 0.370 end
  group
    atom CA  type=CH1E   charge= 0.200 end
    atom HA  type=HA     charge= 0.000 end
  group
    atom CB  type=CH2E   charge= 0.180 end
    atom HB1 type=HA     charge= 0.000 end
    atom HB2 type=HA     charge= 0.000 end
  group
    atom SG  type=SH1E   charge=-0.450 end
    atom HG  type=H      charge= 0.270 end
  group
    atom C   type=C      charge= 0.500 end
    atom O   type=O      charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB SG     bond SG HG 
  bond CA C
  bond C  O

  improper HA N C CB   !chirality CA
  improper HB1 HB2 CA SG  !stereo CB

  !DIHE_ dihedral SG  CB  CA  N

  DONO HN   N
  DONO HG  SG
  !!! ACCE SG    !REMOVED, ATB
  ACCE O    C
end

!----------------------------------------------------------------------

residue GLN
  group
    atom N    type=NH1     charge=-0.570 end
    atom HN   type=H       charge= 0.370 end
  group
    atom CA   type=CH1E    charge= 0.200 end
    atom HA   type=HA      charge= 0.000 end
  group
    atom CB   type=CH2E    charge= 0.000 end
    atom HB1  type=HA      charge= 0.000 end
    atom HB2  type=HA      charge= 0.000 end
  group
    atom CG   type=CH2E    charge= 0.000 end
    atom HG1  type=HA      charge= 0.000 end
    atom HG2  type=HA      charge= 0.000 end
  group
    atom CD   type=C       charge= 0.500 end
    atom OE1  type=O       charge=-0.500 end
  group
    atom NE2  type=NH2     charge=-0.850 end
    atom HE21 type=H       charge= 0.425 end
    atom HE22 type=H       charge= 0.425 end
  group
    atom C    type=C       charge= 0.500 end
    atom O    type=O       charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA  HA
  bond CA CB     bond CB  HB1     bond CB  HB2
  bond CB CG     bond CG  HG1     bond CG  HG2
  bond CG CD
  bond CD OE1
  bond CD NE2    bond NE2 HE21    bond NE2 HE22
  bond CA C
  bond C  O

  improper HA  N  C    CB  !chirality CA
  improper CD  CG OE1  NE2
  improper NE2 CD HE21 HE22
  improper CG  CD NE2  HE21
  improper HB1 HB2 CA CG  !stereo CB
  improper HG1 HG2 CB CD  !stereo CG

  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral CD  CG  CB  CA
  !DIHE_ dihedral OE1 CD  CG  CB 

  DONO HN   N
  DONO HE21 NE2
  DONO HE22 NE2
  ACCE OE1  CD
  ACCE O    C
end

!----------------------------------------------------------------------

residue GLU
  group
    atom N   type=NH1    charge=-0.570 end
    atom HN  type=H      charge= 0.370 end
  group
    atom CA  type=CH1E   charge= 0.200 end
    atom HA  type=HA     charge= 0.000 end
  group
    atom CB  type=CH2E   charge= 0.000 end
    atom HB1 type=HA     charge= 0.000 end
    atom HB2 type=HA     charge= 0.000 end
  group
    atom CG  type=CH2E   charge=-0.100 end
    atom HG1 type=HA     charge= 0.000 end
    atom HG2 type=HA     charge= 0.000 end
  group
    atom CD  type=C      charge= 0.700 end
    atom OE1 type=OC     charge=-0.800 end
    atom OE2 type=OC     charge=-0.800 end
  group
    atom C   type=C      charge= 0.500 end
    atom O   type=O      charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG     bond CG HG1     bond CG HG2
  bond CG CD
  bond CD OE1
  bond CD OE2
  bond CA C
  bond C  O

  improper HA N  C   CB    !chirality CA
  improper CD CG OE1 OE2  ! planar CD
  improper HB1 HB2 CA CG  !stereo CB
  improper HG1 HG2 CB CD  !stereo CG

  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral CD  CG  CB  CA
  !DIHE_ dihedral OE1 CD  CG  CB ! mult 2 ! UCL

  DONO HN   N
  ACCE OE1  CD
  ACCE OE2  CD
  ACCE O    C
end

!----------------------------------------------------------------------

residue GLUH  ! Protonated GLU
  group
    atom N   type=NH1    charge=-0.570 end
    atom HN  type=H      charge= 0.370 end
  group
    atom CA  type=CH1E   charge= 0.200 end
    atom HA  type=HA     charge= 0.000 end
  group
    atom CB  type=CH2E   charge= 0.000 end
    atom HB1 type=HA     charge= 0.000 end
    atom HB2 type=HA     charge= 0.000 end
  group
    atom CG  type=CH2E   charge= 0.000 end
    atom HG1 type=HA     charge= 0.000 end
    atom HG2 type=HA     charge= 0.000 end
  group
    atom CD  type=C      charge= 0.500 end
    atom OE1 type=OC     charge=-0.500 end
    atom OE2 type=OH1    charge=-0.450 end
    atom HE2 type=H      charge= 0.450 end
  group
    atom C   type=C      charge= 0.500 end
    atom O   type=O      charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG     bond CG HG1     bond CG HG2
  bond CG CD
  bond CD OE1
  bond CD OE2    bond OE2 HE2
  bond CA C
  bond C  O

  improper HA N  C   CB    !chirality CA
  improper CD CG OE1 OE2
  improper HB1 HB2 CA CG  !stereo CB
  improper HG1 HG2 CB CD  !stereo CG

  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral CD  CG  CB  CA
  !DIHE_ dihedral OE1 CD  CG  CB ! mult 2 ! UCL

  DONO HN   N
  DONO HE2  OE2
  ACCE OE1  CD
  ACCE OE2  CD
  ACCE O    C
end

!----------------------------------------------------------------------

residue GLY
  group
    atom N   type=NH1    charge=-0.570 end
    atom HN  type=H      charge= 0.370 end
  group
    atom CA  type=CH2G   charge= 0.200 end
    atom HA1 type=HA     charge= 0.000 end
    atom HA2 type=HA     charge= 0.000 end
  group
    atom C   type=C      charge= 0.500 end
    atom O   type=O      charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA1     bond CA HA2
  bond CA C
  bond C  O

  DONO HN   N
  ACCE O    C

  improper HA1 HA2 N C  !stereo CA
end

!----------------------------------------------------------------------

residue NEP  ! Phosphorylated HIS (at NE2)
  group
    atom N   type=NH1     charge=-0.570 end
    atom HN  type=H       charge= 0.370 end
  group
    atom CA  type=CH1E    charge= 0.200 end
    atom HA  type=HA      charge= 0.000 end
  group
    atom CB  type=CH2E    charge= 0.000 end
    atom HB1 type=HA      charge= 0.000 end
    atom HB2 type=HA      charge= 0.000 end
  group
    atom CG  type=C5      charge= 0.330 end
    atom ND1 type=NH1     charge=-0.540 end
    atom HD1 type=H       charge= 0.460 end
  group
    atom CD2 type=CR1H    charge= 0.330 end
    atom HD2 type=HAR     charge= 0.000 end
  group
    atom CE1 type=CRHH    charge= 0.500 end
    atom HE1 type=HAR     charge= 0.000 end
  group
    atom NE2 type=NR      charge=-0.440 end
    atom P   type=PP      charge= 0.520 end
    atom O1P type=OPT     charge=-0.720 end
    atom O2P type=OPT     charge=-0.720 end
    atom O3P type=OPT     charge=-0.720 end
  group
    atom C   type=C       charge= 0.500 end
    atom O   type=O       charge=-0.500 end

  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB1     bond CB  HB2
  bond CB  CG
  bond CG  ND1    bond ND1 HD1
  bond ND1 CE1    bond CE1 HE1
  bond CG  CD2    bond CD2 HD2
  bond CD2 NE2    bond NE2 P  
  bond CE1 NE2
  bond P   O1P  
  bond P   O2P    
  bond P   O3P    
  bond CA  C
  bond C   O

  improper HA  N   C   CB  !chirality CA
  improper CG  CB  ND1 CD2
  improper ND1 CE1 CG  HD1
  improper CD2 NE2 CG  HD2
  improper CE1 ND1 NE2 HE1
  improper CG  ND1 CE1 NE2
  improper ND1 CE1 NE2 CD2
  improper CE1 NE2 CD2 CG
  improper NE2 CD2 CG  ND1
  improper CD2 CG  ND1 CE1
  improper HB1 HB2 CA CG  !stereo CB
  improper NE2   P     CD2   CE1  

  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral ND1 CG  CB  CA
  !DIHE_ dihedral CD2 CG  CB  CA
  !DIHE_ dihedral O3P P   NE2 CE1  

  DONO HN   N
  DONO HD1  ND1
  DONO HE2  NE2
  ACCE O    C
  ACCE O1P  P
  ACCE O2P  P
  ACCE O3P  P
end

!----------------------------------------------------------------------

residue HIS  ! doubly protonated HIS
  group
    atom N   type=NH1     charge=-0.570 end
    atom HN  type=H       charge= 0.370 end
  group
    atom CA  type=CH1E    charge= 0.200 end
    atom HA  type=HA      charge= 0.000 end
  group
    atom CB  type=CH2E    charge= 0.000 end
    atom HB1 type=HA      charge= 0.000 end
    atom HB2 type=HA      charge= 0.000 end
  group
    atom CG  type=C5      charge= 0.330 end
  group
    atom ND1 type=NH1     charge=-0.540 end
    atom HD1 type=H       charge= 0.460 end
  group
    atom CD2 type=CR1H    charge= 0.330 end
    atom HD2 type=HAR     charge= 0.000 end
  group
    atom CE1 type=CRHH    charge= 0.500 end
    atom HE1 type=HAR     charge= 0.000 end
  group
    atom NE2 type=NH1     charge=-0.540 end
    atom HE2 type=H       charge= 0.460 end
  group
    atom C   type=C       charge= 0.500 end
    atom O   type=O       charge=-0.500 end

  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB1     bond CB  HB2
  bond CB  CG
  bond CG  ND1    bond ND1 HD1
  bond ND1 CE1    bond CE1 HE1
  bond CG  CD2    bond CD2 HD2
  bond CD2 NE2    bond NE2 HE2
  bond CE1 NE2
  bond CA  C
  bond C   O

  improper HA  N   C   CB  !chirality CA
  improper CG  CB  ND1 CD2 ! planar CG
  improper NE2 CE1 CD2 HE2 ! added 1/10/2012 Pieter Hendrickx (planar NE2)
  improper ND1 CE1 CG  HD1 ! planar ND1
  improper CD2 NE2 CG  HD2 ! planar CD2
  improper CE1 ND1 NE2 HE1 ! planar CE1
  improper CG  ND1 CE1 NE2
  improper ND1 CE1 NE2 CD2
  improper CE1 NE2 CD2 CG
  improper NE2 CD2 CG  ND1
  improper CD2 CG  ND1 CE1
  improper HB1 HB2 CA CG  !stereo CB

  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral ND1 CG  CB  CA
  !DIHE_ dihedral CD2 CG  CB  CA ! UCL added 09-MAR-00

  DONO HN   N
  DONO HD1  ND1
  DONO HE2  NE2
  ACCE O    C
end

!----------------------------------------------------------------------

residue HISE  ! singly protonated HIS (at NE2) - adapted from HISE patch [GAB, 25-MAY-2017]
  group
    atom N   type=NH1     charge=-0.570 end
    atom HN  type=H       charge= 0.370 end
  group
    atom CA  type=CH1E    charge= 0.200 end
    atom HA  type=HA      charge= 0.000 end
  group
    atom CB  type=CH2E    charge= 0.000 end
    atom HB1 type=HA      charge= 0.000 end
    atom HB2 type=HA      charge= 0.000 end
  group
    atom CG  type=C5      charge= 0.130 end
  group
    atom ND1 type=NR      charge=-0.570 end
  group
    atom CD2 type=CR1E    charge= 0.100 end
    atom HD2 type=HAR     charge= 0.000 end
  group
    atom CE1 type=CRH     charge= 0.410 end
    atom HE1 type=HAR     charge= 0.000 end
  group
    atom NE2 type=NH1     charge=-0.570 end
    atom HE2 type=H       charge= 0.420 end
  group
    atom C   type=C       charge= 0.500 end
    atom O   type=O       charge=-0.500 end

  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB1     bond CB  HB2
  bond CB  CG
  bond CG  ND1    
  bond ND1 CE1    bond CE1 HE1
  bond CG  CD2    bond CD2 HD2
  bond CD2 NE2    bond NE2 HE2
  bond CE1 NE2
  bond CA  C
  bond C   O

  improper HA  N   C   CB  !chirality CA
  improper CG  CB  ND1 CD2
  improper NE2 CE1 CD2 HE2 ! added 1/10/2012 Pieter Hendrickx
  improper CD2 NE2 CG  HD2
  improper CE1 ND1 NE2 HE1
  improper CG  ND1 CE1 NE2
  improper ND1 CE1 NE2 CD2
  improper CE1 NE2 CD2 CG
  improper NE2 CD2 CG  ND1
  improper CD2 CG  ND1 CE1
  improper HB1 HB2 CA CG  !stereo CB

  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral ND1 CG  CB  CA
  !DIHE_ dihedral CD2 CG  CB  CA ! UCL added 09-MAR-00

  DONO HN   N
  DONO HE2  NE2
  ACCE O    C
end


!----------------------------------------------------------------------

residue HISD  ! singly protonated HIS (at ND1) - adapted from HISD patch [GAB, 25-MAY-2017]
  group
    atom N   type=NH1     charge=-0.570 end
    atom HN  type=H       charge= 0.370 end
  group
    atom CA  type=CH1E    charge= 0.200 end
    atom HA  type=HA      charge= 0.000 end
  group
    atom CB  type=CH2E    charge= 0.000 end
    atom HB1 type=HA      charge= 0.000 end
    atom HB2 type=HA      charge= 0.000 end
  group
    atom CG  type=C5      charge= 0.130 end
  group
    atom ND1 type=NH1     charge=-0.570 end
    atom HD1 type=H       charge= 0.420 end
  group
    atom CD2 type=CR1E    charge= 0.100 end
    atom HD2 type=HAR     charge= 0.000 end
  group
    atom CE1 type=CRH     charge= 0.410 end
  group
    atom HE1 type=HAR     charge= 0.000 end
    atom NE2 type=NR      charge=-0.490 end
  group
    atom C   type=C       charge= 0.500 end
    atom O   type=O       charge=-0.500 end

  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB1     bond CB  HB2
  bond CB  CG
  bond CG  ND1    bond ND1 HD1
  bond ND1 CE1    bond CE1 HE1
  bond CG  CD2    bond CD2 HD2
  bond CD2 NE2    
  bond CE1 NE2
  bond CA  C
  bond C   O

  improper HA  N   C   CB  !chirality CA
  improper CG  CB  ND1 CD2
  improper ND1 CE1 CG  HD1
  improper CD2 NE2 CG  HD2
  improper CE1 ND1 NE2 HE1
  improper CG  ND1 CE1 NE2
  improper ND1 CE1 NE2 CD2
  improper CE1 NE2 CD2 CG
  improper NE2 CD2 CG  ND1
  improper CD2 CG  ND1 CE1
  improper HB1 HB2 CA CG  !stereo CB

  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral ND1 CG  CB  CA
  !DIHE_ dihedral CD2 CG  CB  CA ! UCL added 09-MAR-00

  DONO HN   N
  DONO HD1  ND1
  ACCE O    C
end


!----------------------------------------------------------------------

residue ILE
  group
    atom N    type=NH1     charge=-0.570 end
    atom HN   type=H       charge= 0.370 end
  group
    atom CA   type=CH1E    charge= 0.200 end
    atom HA   type=HA      charge= 0.000 end
  group
    atom CB   type=CH1E    charge= 0.000 end
    atom HB   type=HA      charge= 0.000 end
  group
    atom CG1  type=CH2E    charge= 0.000 end
    atom HG11 type=HA      charge= 0.000 excl = (HG21 HG22 HG23 HD11 HD12 HD13) end
    atom HG12 type=HA      charge= 0.000 excl = (HG21 HG22 HG23 HD11 HD12 HD13) end
  group
    atom CG2  type=CH3E    charge= 0.000 end
    atom HG21 type=HA      charge= 0.000 excl = (HG11 HG12 HD11 HD12 HD13) end
    atom HG22 type=HA      charge= 0.000 excl = (HG11 HG12 HD11 HD12 HD13) end
    atom HG23 type=HA      charge= 0.000 excl = (HG11 HG12 HD11 HD12 HD13) end
  group
    atom CD1  type=CH3E    charge= 0.000 end
    atom HD11 type=HA      charge= 0.000 excl = (HG21 HG22 HG23 HG11 HG12) end
    atom HD12 type=HA      charge= 0.000 excl = (HG21 HG22 HG23 HG11 HG12) end
    atom HD13 type=HA      charge= 0.000 excl = (HG21 HG22 HG23 HG11 HG12) end
  group
    atom C    type=C       charge= 0.500 end
    atom O    type=O       charge=-0.500 end
  
  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB
  bond CB  CG1    bond CG1 HG11    bond CG1 HG12
  bond CB  CG2    bond CG2 HG21    bond CG2 HG22    bond CG2 HG23
  bond CG1 CD1    bond CD1 HD11    bond CD1 HD12    bond CD1 HD13
  bond CA  C
  bond C   O

  improper HA N  C   CB   !chirality CA
  improper HB CA CG2 CG1  !chirality CB
  
  improper HG11 HG12 CB CD1  !stereo CG1
  improper HG21 HG22 CB HG23   !methyl CG2
  improper HD11 HD12 CG1 HD13  !methyl CD1

  !DIHE_ dihedral CG1 CB  CA  N
  !DIHE_ dihedral CD1 CG1 CB  CA
  !DIHE_ dihedral HD11 CD1 CG1 CB   ! UCL methyl stagger 12-MAR-00 
  !DIHE_ dihedral HG21 CG2 CB  CA   ! UCL methyl stagger 12-MAR-00 

  DONO HN   N
  ACCE O    C
end

!----------------------------------------------------------------------

residue LEU
  group
    atom N    type=NH1    charge=-0.570 end
    atom HN   type=H      charge= 0.370 end
  group
    atom CA   type=CH1E   charge= 0.200 end
    atom HA   type=HA     charge= 0.000 end
  group
    atom CB   type=CH2E   charge= 0.000 end
    atom HB1  type=HA     charge= 0.000 end
    atom HB2  type=HA     charge= 0.000 end
  group
    atom CG   type=CH1E   charge= 0.000 end
    atom HG   type=HA     charge= 0.000 end
  group
    atom CD1  type=CH3E   charge= 0.000 end
    atom HD11 type=HA     charge= 0.000 excl = (HD21 HD22 HD23 HG) end
    atom HD12 type=HA     charge= 0.000 excl = (HD21 HD22 HD23 HG) end
    atom HD13 type=HA     charge= 0.000 excl = (HD21 HD22 HD23 HG) end
  group
    atom CD2  type=CH3E   charge= 0.000 end
    atom HD21 type=HA     charge= 0.000 excl = (HD11 HD12 HD13 HG) end
    atom HD22 type=HA     charge= 0.000 excl = (HD11 HD12 HD13 HG) end
    atom HD23 type=HA     charge= 0.000 excl = (HD11 HD12 HD13 HG) end
  group
    atom C    type=C      charge= 0.500 end
    atom O    type=O      charge=-0.500 end

  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB1     bond CB  HB2
  bond CB  CG     bond CG  HG
  bond CG  CD1    bond CD1 HD11    bond CD1 HD12    bond CD1 HD13
  bond CG  CD2    bond CD2 HD21    bond CD2 HD22    bond CD2 HD23
  bond CA  C
  bond C   O

  improper HA   N    C   CB    !chirality CA
  improper HG   CB   CD1 CD2   !stereo CG
  improper HB1 HB2 CA CG       !stereo CB
  improper HD11 HD12 CG HD13   !methyl CD1
  improper HD21 HD22 CG HD23   !methyl CD2
    
  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral CD1 CG  CB  CA
  !DIHE_ dihedral HD11 CD1 CG  CB   ! UCL methyl stagger 12-MAR-00 
  !DIHE_ dihedral HD21 CD2 CG  CB   ! UCL methyl stagger 12-MAR-00 

  DONO HN   N
  ACCE O    C
end

!----------------------------------------------------------------------

residue LYS
  group
    atom N   type=NH1    charge=-0.570 end
    atom HN  type=H      charge= 0.370 end
  group
    atom CA  type=CH1E   charge= 0.200 end
    atom HA  type=HA     charge= 0.000 end
  group
    atom CB  type=CH2E   charge= 0.000 end
    atom HB1 type=HA     charge= 0.000 end
    atom HB2 type=HA     charge= 0.000 end
  group
    atom CG  type=CH2E   charge= 0.000 end
    atom HG1 type=HA     charge= 0.000 end
    atom HG2 type=HA     charge= 0.000 end
  group
    atom CD  type=CH2E   charge= 0.000 end
    atom HD1 type=HA     charge= 0.000 end
    atom HD2 type=HA     charge= 0.000 end
  group
    atom CE  type=CH2E   charge= 0.310 end
    atom HE1 type=HA     charge= 0.000 end
    atom HE2 type=HA     charge= 0.000 end
  group
    atom NZ  type=NH3    charge=-0.300 end
    atom HZ1 type=HC     charge= 0.330 end
    atom HZ2 type=HC     charge= 0.330 end
    atom HZ3 type=HC     charge= 0.330 end
  group
    atom C   type=C      charge= 0.500 end
    atom O   type=O      charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG     bond CG HG1     bond CG HG2
  bond CG CD     bond CD HD1     bond CD HD2
  bond CD CE     bond CE HE1     bond CE HE2
  bond CE NZ     bond NZ HZ1     bond NZ HZ2     bond NZ HZ3
  bond CA C
  bond C  O

  improper HA N C CB      !chirality CA
  improper HB1 HB2 CA CG  !stereo CB
  improper HG1 HG2 CB CD  !stereo CG
  improper HD1 HD2 CG CE  !stereo CD
  improper HE1 HE2 CD NZ  !stereo CE
  improper HZ1 HZ2 CE HZ3 !methyl NZ

  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral CD  CG  CB  CA
  !DIHE_ dihedral CE  CD  CG  CB
  !DIHE_ dihedral NZ  CE  CD  CG
  !DIHE_ dihedral HZ1 NZ  CE  CD ! UCL stagger NH3 group 12-MAR-00

  DONO HN   N
  DONO HZ1  NZ
  DONO HZ2  NZ
  DONO HZ3  NZ
  ACCE O    C
end

!----------------------------------------------------------------------

residue ALY  ! NZ-acetyl lysine
  group
    atom N   type=NH1    charge=-0.570 end
    atom HN  type=H      charge= 0.370 end
  group
    atom CA  type=CH1E   charge= 0.200 end
    atom HA  type=HA     charge= 0.000 end
  group
    atom CB  type=CH2E   charge= 0.000 end
    atom HB1 type=HA     charge= 0.000 end
    atom HB2 type=HA     charge= 0.000 end
  group
    atom CG  type=CH2E   charge= 0.000 end
    atom HG1 type=HA     charge= 0.000 end
    atom HG2 type=HA     charge= 0.000 end
  group
    atom CD  type=CH2E   charge= 0.000 end
    atom HD1 type=HA     charge= 0.000 end
    atom HD2 type=HA     charge= 0.000 end
  group
    atom CE  type=CH2E   charge= 0.200 end
    atom HE1 type=HA     charge= 0.000 end
    atom HE2 type=HA     charge= 0.000 end
  group
    atom NZ  type=NH1    charge=-0.570 end
    atom HZ1 type=H      charge= 0.370 end
  group
    atom CZ  type=C      charge= 0.500 end
    atom OZ  type=O      charge=-0.500 end
  group
    atom CM  type=CH3E   charge= 0.000 end
    atom HM1 type=HA     charge= 0.000 end
    atom HM2 type=HA     charge= 0.000 end
    atom HM3 type=HA     charge= 0.000 end
  group
    atom C   type=C      charge= 0.500 end
    atom O   type=O      charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG     bond CG HG1     bond CG HG2
  bond CG CD     bond CD HD1     bond CD HD2
  bond CD CE     bond CE HE1     bond CE HE2
  bond CE NZ     bond NZ HZ1     bond NZ CZ     bond CZ OZ   bond CZ CM
  bond CM HM1    bond CM HM2     bond CM HM3
  bond CA C
  bond C  O

  improper HA N C CB      !chirality CA
  improper HB1 HB2 CA CG  !stereo CB
  improper HG1 HG2 CB CD  !stereo CG
  improper HD1 HD2 CG CE  !stereo CD
  improper HE1 HE2 CD NZ  !stereo CE
  improper HM1 HM2 CZ HM3 !methyl CM
  improper CZ  CM  NZ OZ  !planar CZ
  improper NZ  CZ  CE HZ1 !planar NZ
  improper CE  NZ  CZ CM  !side-chain peptide plane

  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral CD  CG  CB  CA
  !DIHE_ dihedral CE  CD  CG  CB
  !DIHE_ dihedral NZ  CE  CD  CG
  !DIHE_ dihedral HZ1 NZ  CE  CD ! UCL stagger NH3 group 12-MAR-00
!  !DIHE_ dihedral CE  NZ  CZ  OZ

  DONO HN   N
  DONO HZ1  NZ
  ACCE O    C
  ACCE OZ   CZ
end

!----------------------------------------------------------------------

residue MLZ ! N-monomethyl lysine, added 30-04-2009 A. Bonvin -- NO STEREO IMPROPERS!!
  group
    atom N    type=NH1   charge=-0.570 end
    atom HN   type=H     charge= 0.370 end
  group
    atom CA   type=CH1E  charge= 0.200 end
    atom HA   type=HA    charge= 0.000 end
  group
    atom CB   type=CH2E  charge= 0.000 end
    atom HB1  type=HA    charge= 0.000 end
    atom HB2  type=HA    charge= 0.000 end
  group
    atom CG   type=CH2E  charge= 0.000 end
    atom HG1  type=HA    charge= 0.000 end
    atom HG2  type=HA    charge= 0.000 end
  group
    atom CD   type=CH2E  charge= 0.000 end
    atom HD1  type=HA    charge= 0.000 end
    atom HD2  type=HA    charge= 0.000 end
  group
    atom CE   type=CH2E  charge=-0.157 end
    atom HE1  type=HA    charge= 0.250 end
    atom HE2  type=HA    charge= 0.250 end
  group
    atom NZ   type=NCM   charge=-0.400 end
    atom HZ1  type=HC    charge= 0.320 end
    atom HZ2  type=HC    charge= 0.320 end
  group
    atom CM3  type=CH3E  charge=-0.333 end
    atom HM31 type=HA    charge= 0.250 end
    atom HM32 type=HA    charge= 0.250 end
    atom HM33 type=HA    charge= 0.250 end
  group
    atom C    type=C     charge= 0.500 end
    atom O    type=O     charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG     bond CG HG1     bond CG HG2
  bond CG CD     bond CD HD1     bond CD HD2
  bond CD CE     bond CE HE1     bond CE HE2
  bond CE NZ     bond NZ HZ1     bond NZ HZ2     bond NZ CM3
  bond CM3 HM31  bond CM3 HM32   bond CM3 HM33
  bond CA C
  bond C  O

  DONO HN   N
  ACCE O    C
end

!----------------------------------------------------------------------

residue MLY ! Dimethyl lysine, added 30-04-2009 A. Bonvin -- NO STEREO IMPROPERS!!
  group
    atom N    type=NH1   charge=-0.570 end
    atom HN   type=H     charge= 0.370 end
  group
    atom CA   type=CH1E  charge= 0.200 end
    atom HA   type=HA    charge= 0.000 end
  group
    atom CB   type=CH2E  charge= 0.000 end
    atom HB1  type=HA    charge= 0.000 end
    atom HB2  type=HA    charge= 0.000 end
  group
    atom CG   type=CH2E  charge= 0.000 end
    atom HG1  type=HA    charge= 0.000 end
    atom HG2  type=HA    charge= 0.000 end
  group
    atom CD   type=CH2E  charge= 0.000 end
    atom HD1  type=HA    charge= 0.000 end
    atom HD2  type=HA    charge= 0.000 end
  group
    atom CE   type=CH2E  charge=-0.154 end
    atom HE1  type=HA    charge= 0.250 end
    atom HE2  type=HA    charge= 0.250 end
  group
    atom NZ   type=NC3   charge=-0.510 end
    atom HZ1  type=HC    charge= 0.330 end
  group
    atom CM2  type=CH3E  charge=-0.333 end
    atom HM21 type=HA    charge= 0.250 end
    atom HM22 type=HA    charge= 0.250 end
    atom HM23 type=HA    charge= 0.250 end
  group
    atom CM3  type=CH3E  charge=-0.333 end
    atom HM31 type=HA    charge= 0.250 end
    atom HM32 type=HA    charge= 0.250 end
    atom HM33 type=HA    charge= 0.250 end
  group
    atom C    type=C     charge= 0.500 end
    atom O    type=O     charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG     bond CG HG1     bond CG HG2
  bond CG CD     bond CD HD1     bond CD HD2
  bond CD CE     bond CE HE1     bond CE HE2
  bond CE NZ     bond NZ HZ1     bond NZ CM2     bond NZ CM3
  bond CM2 HM21  bond CM2 HM22   bond CM2 HM23
  bond CM3 HM31  bond CM3 HM32   bond CM3 HM33
  bond CA C
  bond C  O

  DONO HN   N
  ACCE O    C
end

!----------------------------------------------------------------------

residue M3L ! trimethyl lysine -- NO STEREO IMPROPERS!!
  group
    atom N    type=NH1   charge=-0.570 end
    atom HN   type=H     charge= 0.370 end
  group
    atom CA   type=CH1E  charge= 0.200 end
    atom HA   type=HA    charge= 0.000 end
  group
    atom CB   type=CH2E  charge= 0.000 end
    atom HB1  type=HA    charge= 0.000 end
    atom HB2  type=HA    charge= 0.000 end
  group
    atom CG   type=CH2E  charge= 0.000 end
    atom HG1  type=HA    charge= 0.000 end
    atom HG2  type=HA    charge= 0.000 end
  group
    atom CD   type=CH2E  charge= 0.000 end
    atom HD1  type=HA    charge= 0.000 end
    atom HD2  type=HA    charge= 0.000 end
  group
    atom CE   type=CH2E  charge=-0.151 end
    atom HE1  type=HA    charge= 0.250 end
    atom HE2  type=HA    charge= 0.250 end
  group
    atom NZ   type=NC4   charge=-0.600 end
  group
    atom CM1  type=CH3E  charge=-0.333 end
    atom HM11 type=HA    charge= 0.250 end
    atom HM12 type=HA    charge= 0.250 end
    atom HM13 type=HA    charge= 0.250 end
  group
    atom CM2  type=CH3E  charge=-0.333 end
    atom HM21 type=HA    charge= 0.250 end
    atom HM22 type=HA    charge= 0.250 end
    atom HM23 type=HA    charge= 0.250 end
  group
    atom CM3  type=CH3E  charge=-0.333 end
    atom HM31 type=HA    charge= 0.250 end
    atom HM32 type=HA    charge= 0.250 end
    atom HM33 type=HA    charge= 0.250 end
  group
    atom C    type=C     charge= 0.500 end
    atom O    type=O     charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG     bond CG HG1     bond CG HG2
  bond CG CD     bond CD HD1     bond CD HD2
  bond CD CE     bond CE HE1     bond CE HE2
  bond CE NZ     bond NZ CM1     bond NZ CM2     bond NZ CM3
  bond CM1 HM11  bond CM1 HM12   bond CM1 HM13
  bond CM2 HM21  bond CM2 HM22   bond CM2 HM23
  bond CM3 HM31  bond CM3 HM32   bond CM3 HM33
  bond CA C
  bond C  O

!  improper HA N C CB         !chirality CA
!  improper HB1 HB2 CA CG     !stereo CB
!  improper HG1 HG2 CB CD     !stereo CG
!  improper HD1 HD2 CG CE     !stereo CD
!  improper HE1 HE2 CD NZ     !stereo CE
!  improper CM1 CM2 CE CM3    !methyl NZ
!  improper HM11 HM12 NZ HM13 !methyl CM1
!  improper HM21 HM22 NZ HM23 !methyl CM1
!  improper HM31 HM32 NZ HM33 !methyl CM1

!  !DIHE_ dihedral CG  CB  CA  N
!  !DIHE_ dihedral CD  CG  CB  CA
!  !DIHE_ dihedral CE  CD  CG  CB
!  !DIHE_ dihedral NZ  CE  CD  CG
!  !DIHE_ dihedral CM1 NZ  CE  CD ! UCL stagger NH3 group 12-MAR-00

  DONO HN   N
  ACCE O    C
end

!----------------------------------------------------------------------

residue MET
  group
    atom N   type=NH1     charge=-0.570 end
    atom HN  type=H       charge= 0.370 end
  group
    atom CA  type=CH1E    charge= 0.200 end
    atom HA  type=HA      charge= 0.000 end
  group
    atom CB  type=CH2E    charge=-0.000 end
    atom HB1 type=HA      charge= 0.000 end
    atom HB2 type=HA      charge= 0.000 end
  group
    atom CG  type=CH2E    charge= 0.235 end
    atom HG1 type=HA      charge= 0.000 end
    atom HG2 type=HA      charge= 0.000 end
  group
    atom SD  type=SM      charge=-0.470 end
  group
    atom CE  type=CH3E    charge= 0.235 end
    atom HE1 type=HA      charge= 0.000 end
    atom HE2 type=HA      charge= 0.000 end
    atom HE3 type=HA      charge= 0.000 end
  group
    atom C   type=C       charge= 0.500 end
    atom O   type=O       charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG     bond CG HG1     bond CG HG2
  bond CG SD
  bond SD CE     bond CE HE1     bond CE HE2     bond CE HE3
  bond CA C
  bond C  O

  improper HA N C CB      !chirality CA
  improper HB1 HB2 CA CG  !stereo CB
  improper HG1 HG2 CB SD  !stereo CG
  improper HE1 HE2 SD HE3 !methyl CE

  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral SD  CG  CB  CA
  !DIHE_ dihedral CE  SD  CG  CB
  !DIHE_ dihedral HE1 CE  SD  CG ! UCL methyl stagger 12-MAR-00

  DONO HN   N
  ACCE O    C
end

!----------------------------------------------------------------------

residue MSE ! SeMET ! added 8-19-2011, ATB
  group
    atom N   type=NH1     charge=-0.570 end
    atom HN  type=H       charge= 0.370 end
  group
    atom CA  type=CH1E    charge= 0.200 end
    atom HA  type=HA      charge= 0.000 end
  group
    atom CB  type=CH2E    charge=-0.000 end
    atom HB1 type=HA      charge= 0.000 end
    atom HB2 type=HA      charge= 0.000 end
  group
    atom CG  type=CH2E    charge= 0.235 end
    atom HG1 type=HA      charge= 0.000 end
    atom HG2 type=HA      charge= 0.000 end
  group
    atom SE  type=SE      charge=-0.470 end
  group
    atom CE  type=CH3E    charge= 0.235 end
    atom HE1 type=HA      charge= 0.000 end
    atom HE2 type=HA      charge= 0.000 end
    atom HE3 type=HA      charge= 0.000 end
  group
    atom C   type=C       charge= 0.500 end
    atom O   type=O       charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG     bond CG HG1     bond CG HG2
  bond CG SE
  bond SE CE     bond CE HE1     bond CE HE2     bond CE HE3
  bond CA C
  bond C  O

  improper HA N C CB      !chirality CA
  improper HB1 HB2 CA CG  !stereo CB
  improper HG1 HG2 CB SE  !stereo CG
  improper HE1 HE2 SE HE3 !methyl CE

  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral SE  CG  CB  CA
  !DIHE_ dihedral CE  SE  CG  CB
  !DIHE_ dihedral HE1 CE  SE  CG ! UCL methyl stagger 12-MAR-00

  DONO HN   N
  ACCE O    C
end

!----------------------------------------------------------------------

residue PHE
  group
    atom N   type=NH1     charge=-0.570 end
    atom HN  type=H       charge= 0.370 end
  group
    atom CA  type=CH1E    charge= 0.200 end
    atom HA  type=HA      charge= 0.000 end
  group
    atom CB  type=CH2E    charge= 0.000 end
    atom HB1 type=HA      charge= 0.000 end
    atom HB2 type=HA      charge= 0.000 end
  group
    atom CG  type=CF      charge= 0.000 exclude=(CZ) end
  group
    atom CD1 type=CR1E    charge= 0.000 exclude=(CE2) end
    atom HD1 type=HAR     charge= 0.000 end
  group
    atom CD2 type=CR1E    charge= 0.000 exclude=(CE1) end
    atom HD2 type=HAR     charge= 0.000 end
  group
    atom CE1 type=CR1E    charge= 0.000 exclude=(CD2) end
    atom HE1 type=HAR     charge= 0.000 end
  group
    atom CE2 type=CR1E    charge= 0.000 exclude=(CD1) end
    atom HE2 type=HAR     charge= 0.000 end
  group
    atom CZ  type=CR1E    charge= 0.000 exclude=(CG) end
    atom HZ  type=HAR     charge= 0.000 end
  group
    atom C   type=C       charge= 0.500 end
    atom O   type=O       charge=-0.500 end
  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB1     bond CB  HB2
  bond CB  CG
  bond CG  CD1    bond CD1 HD1
  bond CG  CD2    bond CD2 HD2
  bond CD1 CE1    bond CE1 HE1
  bond CD2 CE2    bond CE2 HE2
  bond CE1 CZ     bond CZ  HZ
  bond CE2 CZ
  bond CA  C
  bond C   O

  improper HA  N   C   CB !chirality CA
  improper HB1 HB2 CA CG  !stereo CB

! Hs and CB around the ring
  improper HD2 CD2 CE2 CZ
  improper HE2 CE2 CZ  CE1
  improper HZ  CZ  CE1 CD1
  improper HE1 CE1 CD1 CG
  improper HD1 CD1 CG  CD2
  improper CB  CG  CD2 CE2

! around the ring
  improper CG  CD1 CE1 CZ 
  improper CD1 CE1 CZ  CE2
  improper CE1 CZ  CE2 CD2
  improper CZ  CE2 CD2 CG
  improper CE2 CD2 CG  CD1
  improper CD2 CG  CD1 CE1

  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral CD1 CG  CB  CA

  DONO HN   N
  ACCE O    C
end

!----------------------------------------------------------------------

residue PRO
  group
    atom N   type=N     charge=-0.570 end
  group
    atom CA  type=CH1E  charge= 0.285 end
    atom HA  type=HA    charge= 0.000 end
  group
    atom CB  type=CH2E  charge= 0.000 end
    atom HB1 type=HA    charge= 0.000 end
    atom HB2 type=HA    charge= 0.000 end
  group
    atom CG  type=CH2P  charge= 0.000 end
    atom HG1 type=HA    charge= 0.000 end
    atom HG2 type=HA    charge= 0.000 end
  group
    atom CD  type=CH2P  charge= 0.285 end
    atom HD1 type=HA    charge= 0.000 end   
    atom HD2 type=HA    charge= 0.000 end   
  group
    atom C   type=C     charge= 0.500 end   
    atom O   type=O     charge=-0.500 end

  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG     bond CG HG1     bond CG HG2
  bond CG CD     bond CD HD1     bond CD HD2
  bond CD N
  bond CA C
  bond C  O

  improper HA N C CB      !chirality CA
  improper HB1 HB2 CA CG  !stereo CB
  improper HG1 HG2 CB CD  !stereo CG
  improper HD1 HD2 CG N   !stereo CD

  ACCE O    C
end

!----------------------------------------------------------------------

residue HYP  ! 4R-hydroxyproline
  group
    atom N   type=N     charge=-0.570 end
  group
    atom CA  type=CH1E  charge= 0.285 end
    atom HA  type=HA    charge= 0.000 end
  group
    atom CB  type=CH2E  charge= 0.000 end
    atom HB1 type=HA    charge= 0.000 end
    atom HB2 type=HA    charge= 0.000 end
  group
    atom CG  type=CH1P  charge= 0.485 end
  group
    atom OG1 type=OH1   charge=-0.700 end   
    atom HG1 type=H     charge= 0.500 end   
    atom HG2 type=HA    charge= 0.000 end   
  group
    atom CD  type=CH2P  charge= 0.000 end
    atom HD1 type=HA    charge= 0.000 end
    atom HD2 type=HA    charge= 0.000 end
  group
    atom C   type=C     charge= 0.500 end   
    atom O   type=O     charge=-0.500 end

  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG     bond CG OG1     bond CG HG2
  bond OG1 HG1
  bond CG CD     bond CD HD1     bond CD HD2
  bond CD N
  bond CA C
  bond C  O

  improper HA N C CB      !chirality CA
  improper HB1 HB2 CA CG  !stereo CB
  improper OG1 HG2 CB CD  !stereo CG
  improper HD1 HD2 CG N   !stereo CD

  ACCE O    C
end

!----------------------------------------------------------------------

residue SER
  group
    atom N   type=NH1    charge=-0.570 end
    atom HN  type=H      charge= 0.370 end
  group
    atom CA  type=CH1E   charge= 0.200 end
    atom HA  type=HA     charge= 0.000 end
  group
    atom CB  type=CH2E   charge= 0.265 end
    atom HB1 type=HA     charge= 0.000 end
    atom HB2 type=HA     charge= 0.000 end
  group
    atom OG  type=OH1    charge=-0.700 end
    atom HG  type=H      charge= 0.435 end
  group
    atom C   type=C      charge= 0.500 end
    atom O   type=O      charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB OG     bond OG HG
  bond O  C
  bond C  CA

  improper HA N C CB      !chirality CA
  improper HB1 HB2 CA OG  !stereo CB

  !DIHE_ dihedral OG  CB  CA  N

  DONO HN   N
  DONO HG   OG
  ACCE OG  " "
  ACCE O    C
end

!----------------------------------------------------------------------

residue SEP !phosphorylated Serine, AB-2008-11
  group
    atom N   type=NH1    charge=-0.570 end
    atom HN  type=H      charge= 0.370 end
  group
    atom CA  type=CH1E   charge= 0.200 end
    atom HA  type=HA     charge= 0.000 end
  group
    atom CB  type=CH2E   charge= 0.265 end
    atom HB1 type=HA     charge= 0.000 end
    atom HB2 type=HA     charge= 0.000 end
  group
    atom OG  type=OHP    charge=-0.625 end
  group
    atom P   type=PP     charge= 0.520 end
    atom O1P type=OPT    charge=-0.720 end
    atom O2P type=OPT    charge=-0.720 end
    atom O3P type=OPT    charge=-0.720 end
  group
    atom C   type=C      charge= 0.500 end
    atom O   type=O      charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB OG     bond OG  P
  bond P   O1P
  bond P   O2P
  bond P   O3P
  bond O  C
  bond C  CA

  improper HA N C CB      !chirality CA
  improper HB1 HB2 CA OG  !stereo CB

  !DIHE_ dihedral OG  CB  CA  N
  !DIHE_ dihedral CB  OG  P   O3P

  DONO HN   N
  DONO HG   OG
  ACCE OG  " "
  ACCE O    C
  ACCE O1P  P
  ACCE O2P  P
  ACCE O3P  P
end

!----------------------------------------------------------------------

residue THR
  group
    atom N    type=NH1 charge=-0.570 end
    atom HN   type=H   charge= 0.370 end
  group
    atom CA   type=CH1E  charge= 0.200 end
    atom HA   type=HA  charge= 0.000 end
  group
    atom CB   type=CH1E  charge= 0.265 end
    atom HB   type=HA  charge= 0.000 end
  group
    atom OG1  type=OH1  charge=-0.700 end
    atom HG1  type=H   charge= 0.435 end
  group
    atom CG2  type=CH3E  charge=-0.000 end
    atom HG21 type=HA  charge= 0.000 end
    atom HG22 type=HA  charge= 0.000 end
    atom HG23 type=HA  charge= 0.000 end
  group
    atom C    type=C   charge= 0.500 end
    atom O    type=O   charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB
  bond CB OG1    bond OG1 HG1
  bond CB CG2    bond CG2 HG21    bond CG2 HG22    bond CG2 HG23
  bond CA C
  bond C  O

  improper HA N  C   CB        !chirality CA
  improper HB CA OG1 CG2       !stereo CB
  improper HG21 HG22 CB HG23   !methyl CG2

  !DIHE_ dihedral OG1 CB  CA  N
  !DIHE_ dihedral HG21 CG2 CB  CA   ! UCL methyl stagger 12-MAR-00 

  DONO HN   N
  DONO HG1  OG1
  ACCE OG1 " "
  ACCE O    C
end

!----------------------------------------------------------------------

residue TPO   ! Phosphothreonine
  group
    atom N    type=NH1 charge=-0.570 end
    atom HN   type=H   charge= 0.370 end
  group
    atom CA   type=CH1E  charge= 0.200 end
    atom HA   type=HA  charge= 0.000 end
  group
    atom CB   type=CH1E  charge= 0.265 end
    atom HB   type=HA  charge= 0.000 end
  group
    atom OG1  type=OHP    charge=-0.625 end
  group
    atom P    type=PP     charge= 0.520 end
    atom O1P  type=OPT    charge=-0.720 end
    atom O2P  type=OPT    charge=-0.720 end
    atom O3P  type=OPT    charge=-0.720 end
  group
    atom CG2  type=CH3E  charge=-0.000 end
    atom HG21 type=HA  charge= 0.000 end
    atom HG22 type=HA  charge= 0.000 end
    atom HG23 type=HA  charge= 0.000 end
  group
    atom C    type=C   charge= 0.500 end
    atom O    type=O   charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB
  bond CB OG1    bond OG1 P
  bond P   O1P
  bond P   O2P
  bond P   O3P

  bond CB CG2    bond CG2 HG21    bond CG2 HG22    bond CG2 HG23
  bond CA C
  bond C  O

  improper HA N  C   CB        !chirality CA
  improper HB CA OG1 CG2       !stereo CB
  improper HG21 HG22 CB HG23   !methyl CG2

  !DIHE_ dihedral OG1 CB  CA  N
  !DIHE_ dihedral CB  OG1 P   O3P
  !DIHE_ dihedral HG21 CG2 CB  CA   ! UCL methyl stagger 12-MAR-00 

  DONO HN   N
  DONO HG1  OG1
  ACCE OG1 " "
  ACCE O    C
end

!----------------------------------------------------------------------

residue TRP
  group
    atom N   type=NH1 charge=-0.570 end
    atom HN  type=H   charge= 0.370 end
  group
    atom CA  type=CH1E  charge= 0.200 end
    atom HA  type=HA  charge= 0.000 end
  group
    atom CB  type=CH2E  charge= 0.000 end
    atom HB1 type=HA  charge= 0.000 end
    atom HB2 type=HA  charge= 0.000 end
  group
    atom CG  type=C5W  charge=-0.055 end
  group
    atom CD1 type=CR1E  charge= 0.130 end
    atom HD1 type=HAR charge= 0.000 end
  group
    atom CD2 type=CW  charge=-0.055 exclude=(CH2) end
  group
    atom NE1 type=NH1 charge=-0.570 end
    atom HE1 type=H   charge= 0.420 end
  group
    atom CE2 type=CW  charge= 0.130 exclude=(CZ3) end
  group
    atom CE3 type=CR1E  charge= 0.000 exclude=(CZ2) end
    atom HE3 type=HAR charge= 0.000 end
  group
    atom CZ2 type=CR1W charge= 0.000 exclude=(CE3) end
    atom HZ2 type=HAR charge= 0.000 end
  group
    atom CZ3 type=CR1E  charge= 0.000 exclude=(CE2) end
    atom HZ3 type=HAR charge= 0.000 end
  group
    atom CH2 type=CR1W charge= 0.000 exclude=(CD2) end
    atom HH2 type=HAR charge= 0.000 end
  group
    atom C   type=C   charge= 0.500 end
    atom O   type=O   charge=-0.500 end

  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB1     bond CB  HB2
  bond CB  CG
  bond CG  CD1    bond CD1 HD1
  bond CG  CD2
  bond CD1 NE1    bond NE1 HE1
  bond NE1 CE2
  bond CD2 CE2
  bond CD2 CE3    bond CE3 HE3
  bond CE2 CZ2    bond CZ2 HZ2
  bond CE3 CZ3    bond CZ3 HZ3
  bond CZ2 CH2    bond CH2 HH2
  bond CZ3 CH2
  bond CA  C
  bond C   O

! chirality
  improper HA  N   C   CB !chirality CA
  improper HB1 HB2 CA CG  !stereo CB

! around the 6-ring
  improper CD2 CE2 CZ2 CH2
  improper CE2 CZ2 CH2 CZ3
  improper CZ2 CH2 CZ3 CE3
  improper CH2 CZ3 CE3 CD2
  improper CZ3 CE3 CD2 CE2
  improper CE3 CD2 CE2 CZ2

! link 5-ring to 6-ring
  improper CD1 NE1 CE2 CZ2
  improper CD1 CG  CD2 CE3
  improper NE1 CE2 CZ2 CH2
  improper NE1 CE2 CD2 CE3
  improper CG  CD2 CE3 CZ3
  improper CG  CD2 CE2 CZ2

! 6-ring hydrogens
  improper HZ2 CZ2 CH2 CZ3
  improper HH2 CH2 CZ3 CE3
  improper HZ3 CZ3 CH2 CZ2
  improper HE3 CE3 CZ3 CH2

! 5-ring hydrogens and CB
  improper HE1 NE1 CE2 CD2
  improper HD1 CD1 NE1 CE2
  improper CB  CG  CD2 CE2

  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral CD1 CG  CB  CA

  DONO HN   N
  DONO HE1  NE1
  ACCE O    C
end

!----------------------------------------------------------------------

residue TYR
  group
    atom N   type=NH1 charge=-0.570 end
    atom HN  type=H   charge= 0.370 end
  group
    atom CA  type=CH1E  charge= 0.200 end
    atom HA  type=HA  charge= 0.000 end
  group
    atom CB  type=CH2E  charge= 0.000 end
    atom HB1 type=HA  charge= 0.000 end
    atom HB2 type=HA  charge= 0.000 end
  group
    atom CG  type=CY  charge= 0.000 exclude=(CZ) end
  group
    atom CD1 type=CR1E  charge= 0.000 exclude=(CE2) end
    atom HD1 type=HAR charge= 0.000 end
  group
    atom CD2 type=CR1E  charge= 0.000 exclude=(CE1) end
    atom HD2 type=HAR charge= 0.000 end
  group
    atom CE1 type=CR1E  charge= 0.000 exclude=(CD2) end
    atom HE1 type=HAR charge= 0.000 end
  group
    atom CE2 type=CR1E  charge= 0.000 exclude=(CD1) end
    atom HE2 type=HAR charge= 0.000 end
  group
    atom CZ  type=CY2   charge= 0.265 exclude=(CG) end
  group
    atom OH  type=OH1  charge=-0.700 end
    atom HH  type=H   charge= 0.435 end
  group
    atom C   type=C   charge= 0.500 end
    atom O   type=O   charge=-0.500 end

  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB1     bond CB  HB2
  bond CB  CG
  bond CG  CD1    bond CD1 HD1
  bond CG  CD2    bond CD2 HD2
  bond CD1 CE1    bond CE1 HE1
  bond CD2 CE2    bond CE2 HE2
  bond CE1 CZ
  bond CE2 CZ
  bond CZ  OH     bond OH  HH
  bond CA  C
  bond C   O

! chirality
  improper HA  N   C   CB !chirality CA
  improper HB1 HB2 CA CG  !stereo CB

! Hs, OH, and CB around the ring
  improper HD2 CD2 CE2 CZ
  improper HE2 CE2 CZ  CE1
  improper OH  CZ  CE1 CD1
  improper HE1 CE1 CD1 CG
  improper HD1 CD1 CG  CD2
  improper CB  CG  CD2 CE2

! around the ring
  improper CG  CD1 CE1 CZ 
  improper CD1 CE1 CZ  CE2
  improper CE1 CZ  CE2 CD2
  improper CZ  CE2 CD2 CG
  improper CE2 CD2 CG  CD1
  improper CD2 CG  CD1 CE1

  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral CD1 CG  CB  CA
  !DIHE_ dihedral CE2 CZ  OH  HH   ! UCL Added 12-MAR-00

  DONO HN   N
  DONO HH   OH
  ACCE OH  " "
  ACCE O    C
end

!----------------------------------------------------------------------

residue TYS   ! sulfonated tyrosine
  group
    atom N   type=NH1 charge=-0.570 end
    atom HN  type=H   charge= 0.370 end
  group
    atom CA  type=CH1E  charge= 0.200 end
    atom HA  type=HA  charge= 0.000 end
  group
    atom CB  type=CH2E  charge= 0.000 end
    atom HB1 type=HA  charge= 0.000 end
    atom HB2 type=HA  charge= 0.000 end
  group
    atom CG  type=CY  charge= 0.000 exclude=(CZ) end
  group
    atom CD1 type=CR1E  charge= 0.000 exclude=(CE2) end
    atom HD1 type=HAR charge= 0.000 end
  group
    atom CD2 type=CR1E  charge= 0.000 exclude=(CE1) end
    atom HD2 type=HAR charge= 0.000 end
  group
    atom CE1 type=CR1E  charge= 0.000 exclude=(CD2) end
    atom HE1 type=HAR charge= 0.000 end
  group
    atom CE2 type=CR1E  charge= 0.000 exclude=(CD1) end
    atom HE2 type=HAR charge= 0.000 end
  group
    atom CZ  type=CY2   charge= 0.265 exclude=(CG) end
  group
    atom OH  type=OUF   charge=-0.625 end
  group
    atom S   type=SUF   charge= 0.520 end
    atom O1S type=OUF   charge=-0.720 end
    atom O2S type=OUF   charge=-0.720 end
    atom O3S type=OUF   charge=-0.720 end
  group
    atom C   type=C   charge= 0.500 end
    atom O   type=O   charge=-0.500 end

  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB1     bond CB  HB2
  bond CB  CG
  bond CG  CD1    bond CD1 HD1
  bond CG  CD2    bond CD2 HD2
  bond CD1 CE1    bond CE1 HE1
  bond CD2 CE2    bond CE2 HE2
  bond CE1 CZ
  bond CE2 CZ
  bond CZ  OH     bond OH  S
  bond S   O1S
  bond S   O2S
  bond S   O3S
  bond CA  C
  bond C   O

! chirality
  improper HA  N   C   CB !chirality CA
  improper HB1 HB2 CA CG  !stereo CB

! Hs, OH, and CB around the ring
  improper HD2 CD2 CE2 CZ
  improper HE2 CE2 CZ  CE1
  improper OH  CZ  CE1 CD1
  improper HE1 CE1 CD1 CG
  improper HD1 CD1 CG  CD2
  improper CB  CG  CD2 CE2

! around the ring
  improper CG  CD1 CE1 CZ 
  improper CD1 CE1 CZ  CE2
  improper CE1 CZ  CE2 CD2
  improper CZ  CE2 CD2 CG
  improper CE2 CD2 CG  CD1
  improper CD2 CG  CD1 CE1
  !improper OH P O3P O1P ! chirality improper   -37.36
     
  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral CD1 CG  CB  CA
  !DIHE_ dihedral CE2 CZ  OH  S   
  !DIHE_ dihedral CZ  OH  S   O3S
  
  DONO HN   N
  DONO HH   OH
  ACCE OH  " "
  ACCE O    C
  ACCE O1S  S
  ACCE O2S  S
  ACCE O3S  S
  
end

!----------------------------------------------------------------------

residue PTR   ! O-phosphotyrosine
  group
    atom N   type=NH1 charge=-0.570 end
    atom HN  type=H   charge= 0.370 end
  group
    atom CA  type=CH1E  charge= 0.200 end
    atom HA  type=HA  charge= 0.000 end
  group
    atom CB  type=CH2E  charge= 0.000 end
    atom HB1 type=HA  charge= 0.000 end
    atom HB2 type=HA  charge= 0.000 end
  group
    atom CG  type=CY  charge= 0.000 exclude=(CZ) end
  group
    atom CD1 type=CR1E  charge= 0.000 exclude=(CE2) end
    atom HD1 type=HAR charge= 0.000 end
  group
    atom CD2 type=CR1E  charge= 0.000 exclude=(CE1) end
    atom HD2 type=HAR charge= 0.000 end
  group
    atom CE1 type=CR1E  charge= 0.000 exclude=(CD2) end
    atom HE1 type=HAR charge= 0.000 end
  group
    atom CE2 type=CR1E  charge= 0.000 exclude=(CD1) end
    atom HE2 type=HAR charge= 0.000 end
  group
    atom CZ  type=CY2   charge= 0.265 exclude=(CG) end
  group
    atom OH  type=OHP  charge=-0.625 end
  group
    atom P   type=PP    charge= 0.520 end
    atom O1P type=OPT   charge=-0.720 end
    atom O2P type=OPT   charge=-0.720 end
    atom O3P type=OPT   charge=-0.720 end
  group
    atom C   type=C   charge= 0.500 end
    atom O   type=O   charge=-0.500 end

  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB1     bond CB  HB2
  bond CB  CG
  bond CG  CD1    bond CD1 HD1
  bond CG  CD2    bond CD2 HD2
  bond CD1 CE1    bond CE1 HE1
  bond CD2 CE2    bond CE2 HE2
  bond CE1 CZ
  bond CE2 CZ
  bond CZ  OH     bond OH  P
  bond P   O1P
  bond P   O2P
  bond P   O3P
  bond CA  C
  bond C   O
  
! chirality
  improper HA  N   C   CB !chirality CA
  improper HB1 HB2 CA CG  !stereo CB

! Hs, OH, and CB around the ring
  improper HD2 CD2 CE2 CZ
  improper HE2 CE2 CZ  CE1
  improper OH  CZ  CE1 CD1
  improper HE1 CE1 CD1 CG
  improper HD1 CD1 CG  CD2
  improper CB  CG  CD2 CE2

! around the ring
  improper CG  CD1 CE1 CZ 
  improper CD1 CE1 CZ  CE2
  improper CE1 CZ  CE2 CD2
  improper CZ  CE2 CD2 CG
  improper CE2 CD2 CG  CD1
  improper CD2 CG  CD1 CE1
  !improper OH P O3P O1P ! chirality or flatness improper   -37.36
     
  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral CD1 CG  CB  CA
  !DIHE_ dihedral CE2 CZ  OH  P   
  !DIHE_ dihedral CZ  OH  P   O3P
  
  DONO HN   N
  DONO HH   OH
  ACCE OH  " "
  ACCE O    C
  ACCE O1P  P
  ACCE O2P  P
  ACCE O3P  P
  
end

!----------------------------------------------------------------------

residue VAL
  group
    atom N    type=NH1 charge=-0.570 end
    atom HN   type=H   charge= 0.370 end
  group
    atom CA   type=CH1E  charge= 0.200 end
    atom HA   type=HA  charge= 0.000 end
  group
    atom CB   type=CH1E  charge= 0.000 end
    atom HB   type=HA  charge= 0.000 end
  group
    atom CG1  type=CH3E  charge= 0.000 end
    atom HG11 type=HA  charge= 0.000 excl = (HG21 HG22 HG23) end
    atom HG12 type=HA  charge= 0.000 excl = (HG21 HG22 HG23) end
    atom HG13 type=HA  charge= 0.000 excl = (HG21 HG22 HG23) end
  group
    atom CG2  type=CH3E  charge=-0.000 end
    atom HG21 type=HA  charge= 0.000 excl = (HG11 HG12 HG13) end
    atom HG22 type=HA  charge= 0.000 excl = (HG11 HG12 HG13) end
    atom HG23 type=HA  charge= 0.000 excl = (HG11 HG12 HG13) end
  group
    atom C    type=C   charge= 0.500 end
    atom O    type=O   charge=-0.500 end

  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB
  bond CB  CG1    bond CG1 HG11    bond CG1 HG12    bond CG1 HG13
  bond CB  CG2    bond CG2 HG21    bond CG2 HG22    bond CG2 HG23
  bond CA  C
  bond C   O

  improper HA N C CB         !chirality CA
  improper HB   CA   CG1 CG2 !stereo CB
  improper HG11 HG12 CB HG13    !methyl G1
  improper HG21 HG22 CB HG23    !methyl G2

  !DIHE_ dihedral CG1 CB  CA  N
  !DIHE_ dihedral HG11 CG1 CB  CA   ! UCL methyl stagger 12-MAR-00 
  !DIHE_ dihedral HG21 CG2 CB  CA   ! UCL methyl stagger 12-MAR-00 

  DONO HN   N
  ACCE O    C
end

!----------------------------------------------------------------------

! Cysteine residue derivatized with iodoacetamido-PROXYL.
!
! Derived from coordinates and parameters kindly provided by Gunnar Jeschke.
! Polyhach Y. et al. Phys. Chem. Chem. Phys. 2011, 13: 2356-2366.
!
! Added by Guillermo A. Bermejo (28 July 2015).


mass HAPX   1.008
mass HPX    1.008
mass CH1X  12.011 
mass CH2X  12.011 
mass CH3X  12.011 
mass CTPX  12.011
mass CPX   12.011
mass NH1X  14.007
mass NN5X  14.007
mass ONPX  15.999
mass OPX   15.999


residue CIAP
  group
    atom N   type=NH1    charge=-0.570 end
    atom HN  type=H      charge= 0.370 end
  group
    atom CA  type=CH1E   charge= 0.200 end
    atom HA  type=HA     charge= 0.000 end
  group
    atom CB  type=CH2E   charge= 0.180 end
    atom HB1 type=HA     charge= 0.000 end
    atom HB2 type=HA     charge= 0.000 end
  group
    atom SG  type=S      charge=-0.300 end ! as in DISU patch
 
    atom C10 type=CH2X   charge=0.417 end
    atom H101 type=HAPX  charge= 0.10 end
    atom H102 type=HAPX  charge= 0.10 end
 
    atom C11 type=CPX    charge= 0.400 end
    atom O2  type=OPX    charge= 0.150 end
 
    atom N2  type=NH1X   charge=0.000 end
    atom H2  type=HPX    charge=0.250 end
 
    atom C3  type=CH1X   charge=0.350 end
    atom H3  type=HAPX   charge= 0.10 end
 
    atom C2  type=CTPX   charge=0.060 end
 
    atom C8  type=CH3X   charge=0.550 end
    atom H81 type=HAPX   charge= 0.10 end
    atom H82 type=HAPX   charge= 0.10 end
    atom H83 type=HAPX   charge= 0.10 end
 
    atom C9  type=CH3X   charge=0.550 end
    atom H91 type=HAPX   charge= 0.10 end
    atom H92 type=HAPX   charge= 0.10 end
    atom H93 type=HAPX   charge= 0.10 end
 
    atom N1  type=NN5X   charge=0.190 end
    atom O1  type=ONPX   charge=0.250 end
 
    atom C5  type=CTPX   charge=0.060 end
 
    atom C6  type=CH3X   charge=0.550 end
    atom H61 type=HAPX   charge= 0.10 end
    atom H62 type=HAPX   charge= 0.10 end
    atom H63 type=HAPX   charge= 0.10 end
 
    atom C7  type=CH3X   charge=0.550 end
    atom H71 type=HAPX   charge= 0.10 end
    atom H72 type=HAPX   charge= 0.10 end
    atom H73 type=HAPX   charge= 0.10 end
 
    atom C4  type=CH2X   charge=0.417 end
    atom H41 type=HAPX   charge= 0.10 end
    atom H42 type=HAPX   charge= 0.10 end 
 
    atom C   type=C      charge= 0.500 end
    atom O   type=O      charge=-0.500 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB SG      
  bond CA C
  bond C  O  

  improper HA N C CB   !chirality CA
  improper HB1 HB2 CA SG  !stereo CB

  !DIHE_ dihedral SG  CB  CA  N

  
  ! Proxyl tag from here on.

  bond SG C10    bond C10 H101   bond C10 H102
  bond C10 C11   bond C11 O2     bond C11 N2
  bond N2 C3     bond N2 H2
  bond C3 C2     bond C3 C4      bond C3 H3
  bond C2 N1     bond C2 C8      bond C2 C9
  bond N1 O1     bond N1 C5
  bond C5 C4     bond C5 C6     bond C5 C7
  bond C4 H41    bond C4 H42
  
  bond C6 H61    bond C6 H62     bond C6 H63
  bond C7 H71    bond C7 H72     bond C7 H73
  bond C8 H81    bond C8 H82     bond C8 H83
  bond C9 H91    bond C9 H92     bond C9 H93
  

  improper H101 H102 SG C11  ! C10 chirality 

  ! Trans amide bond (as in presidue PEPT in protein-1.0.*).
  improper O2  C11 N2  C3
  improper H2  N2  C11 C10
  improper C10 C11 N2  C3

  improper H3 C4 N2 C2  ! C3 chirality 
  improper C8 C9 C3 N1  ! C2 chirality 

  improper O1 C5 C2 N1  ! planar N1

  improper C6 C7 N1 C4   ! C5 chirality 
  improper H41 H42 C5 C3  ! C4 chirality 

  improper H61 H62 C5 H63  ! C6 chirality  
  improper H71 H72 C5 H73  ! C7 chirality 

  improper H81 H82 C2 H83  ! C8 chirality 
  improper H91 H92 C2 H93  ! C9 chirality 

  !DIHE_ dihedral CA CB SG C10
  !DIHE_ dihedral CB SG C10 C11
  !DIHE_ dihedral SG C10 C11 N2
  !DIHE_ dihedral C11 N2 C3 C2

  DONO HN   N
  ACCE O    C

end


!----------------------------------------------------------------------

! Spin label tag:
! Cysteine with MTSL aduct (nitroxide spin label) attached via S-S bond
!  CDS added 2008/02/09
!
! Originally:
! file parallhdg.spn  version 4.01  date 29-Jul-96
! file topallhdg.spn  version 4.01  date 29-Jul-96
! Geometric energy function parameters for distance geometry and
! simulated annealing of spin label modified proteins.
! Author: John Battiste, Harvard Medical School


mass CS1  12.011  
mass CSN1 12.011 
mass CSN2 12.011 
mass CS2  12.011
mass C3S6 12.011
mass C3S7 12.011
mass C3S8 12.011
mass C3S9 12.011
mass NOR1 14.007
mass ONR1 15.999


residue CYSP
  group
    atom N   type=NH1    charge=-0.570 end
    atom HN  type=H      charge= 0.370 end
  group
    atom CA  type=CH1E   charge= 0.200 end
    atom HA  type=HA     charge= 0.000 end
  group
    atom CB  type=CH2E   charge= 0.180 end
    atom HB1 type=HA     charge= 0.000 end
    atom HB2 type=HA     charge= 0.000 end
  group
    atom SG1 type=S      charge=-0.300 end ! as in DISU patch

    atom SG2 type=S      charge=-0.19 end
    atom CL1 type=CH2E   charge=0.00 end
    atom HL11 type=HA    charge=0.00 end
    atom HL12 type=HA    charge=0.00 end
    atom CS3 type=CS1    charge=0.00 end
    atom CS2 type=CSN1   charge=0.00 end
    atom CS8 type=C3S8   charge=0.00 end
    atom HS81 type=HA    charge=0.00 end
    atom HS82 type=HA    charge=0.00 end
    atom HS83 type=HA    charge=0.00 end
    atom CS9 type=C3S9   charge=0.00 end
    atom HS91 type=HA    charge=0.00 end
    atom HS92 type=HA    charge=0.00 end
    atom HS93 type=HA    charge=0.00 end
    atom NS1 type=NOR1   charge=0.00 end
    atom OS1 type=ONR1   charge=0.00 end
    atom CS5 type=CSN2   charge=0.00 end
    atom CS7 type=C3S7   charge=0.00 end
    atom HS71 type=HA    charge=0.00 end
    atom HS72 type=HA    charge=0.00 end
    atom HS73 type=HA    charge=0.00 end
    atom CS6 type=C3S6   charge=0.00 end
    atom HS61 type=HA    charge=0.00 end
    atom HS62 type=HA    charge=0.00 end
    atom HS63 type=HA    charge=0.00 end
    atom CS4  type=CS2   charge=0.00 end
    atom HS4  type=HAR   charge=0.00 end
  group
    atom C   type=C      charge= 0.48 end
    atom O   type=O      charge=-0.48 end


  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB SG1      
  bond CA C
  bond C  O  

  improper HA N C CB   !chirality CA
  improper HB1 HB2 CA SG1  !stereo CB

  !DIHE_ dihedral SG1  CB  CA  N

  ! Tag from here on.

  ! No dihedrals for tag.

  bond SG1 SG2
  bond SG2 CL1   bond CL1 HL11   bond CL1 HL12
  bond CL1 CS3
  bond CS3 CS2
  bond CS2 CS8  bond CS8 HS81 bond CS8 HS82 bond CS8 HS83
  bond CS2 CS9  bond CS9 HS91 bond CS9 HS92 bond CS9 HS93
  bond CS2 NS1  bond NS1 OS1
  bond NS1 CS5
  bond CS5 CS6  bond CS6 HS61 bond CS6 HS62 bond CS6 HS63
  bond CS5 CS7  bond CS7 HS71 bond CS7 HS72 bond CS7 HS73
  bond CS5 CS4  bond CS4 HS4
  bond CS4 CS3

  improper HL11 HL12 CS3 SG2 !stereo CL1
  improper CS8 CS9 NS1 CS3 !stereo CS2
  improper CS6 CS7 NS1 CS4 !stereo CS5

  improper HS61 HS62 HS63 CS5 ! CS6 center
  improper HS71 HS72 HS73 CS5 ! CS7 center
  improper HS81 HS82 HS83 CS2 ! CS8 center
  improper HS91 HS92 HS93 CS2 ! CS9 center

  improper OS1 NS1 CS2 CS5
  improper HS4 CS4 CS5 CS3
  improper CL1 CS3 CS2 CS4

  improper NS1 CS2 CS3 CS4
  improper CS2 CS3 CS4 CS5
  improper CS3 CS4 CS5 NS1
  improper CS4 CS5 NS1 CS2
  improper CS5 NS1 CS2 CS3


  DONO HN   N
  ACCE O    C

end

!----------------------------------------------------------------------

! Spin label tag:
! Cysteine with EDTA-Mn spin label attached via S-S bond
!  Metal chelation and structure from Inorg. Chem. 3, 27 (1964).
!  CDS added 2008/02/09
!

! Atom names:
!                                                             HY21     OY2
!                                                              |      /   
!                                                             CY2--CY6    
!                                             HYA1 HYB1     /  |      \ 
!                                              |    |      /  HY22     OY6
!                                             CYA--CYB--NYB                  
!              H111 H121 H13       HY11     /  |    |      \  HY31     OY3
!               |    |   |         |       /  HYA2 HYB2     \  |      /   
!   Cys-SG-SD--C11--C12--N13--CY5--CY1--NYA                   CY3--CY7    
!               |    |        |    |       \  HY41     OY4     |      \   
!              H112 H122      OY1  HY12     \  |      /       HY32     OY7
!                                             CY4--CY8
!                                              |      \
!                                             HY42     OY8
! Atom types:                                                                   
!                                                             HJ49     MO2
!                                                              |      /   
!                                                             CJ18--CJ19    
!                                             HJ45 HJ45     /  |      \ 
!                                              |    |      /  HJ50     OJ20
!                                             CJ15-CJ15-NYB                  
!              HJ38 HJ38 HJ37      HJ43     /  |    |      \  HJ49     MO3
!               |    |   |         |       /  HJ46 HJ46     \  |      /   
!   Cys--S--S--CJ8--CJ8--NJ7--CJ11-CJ13-NYA                   CJ17--CJ19    
!               |    |        |    |       \  HJ49     MO4     |      \   
!              HJ39 HJ39      MO1  HJ44     \  |      /       HJ50     OJ20
!                                             CJ18-CJ19
!                                              |      \
!                                             HJ50     OJ20



MASS NJ7    14.00700 
MASS CJ8    12.01100
MASS HJ37    1.00800 
MASS HJ38    1.00800 
MASS HJ39    1.00800 
MASS CJ11 12.011
MASS CJ13 12.011
MASS NYA 14.007
MASS NYB 14.007
MASS CJ15 12.011
MASS CJ17 12.011
MASS CJ18 12.011
MASS CJ19 12.011
MASS OJ20 15.999
MASS HJ43  1.008
MASS HJ44  1.008
MASS HJ45  1.008
MASS HJ46  1.008
MASS HJ49  1.008
MASS HJ50  1.008

MASS   MN   54.938
mass  MO1  15.999
mass  MO2  15.999
mass  MO3  15.999
mass  MO4  15.999

residue CED
  group
    atom N   type=NH1    charge=-0.570 end
    atom HN  type=H      charge= 0.370 end
  group
    atom CA  type=CH1E   charge= 0.200 end
    atom HA  type=HA     charge= 0.000 end
  group
    atom CB  type=CH2E   charge= 0.180 end
    atom HB1 type=HA     charge= 0.000 end
    atom HB2 type=HA     charge= 0.000 end
  group
    atom SG  type=S      charge=-0.300 end ! as in DISU patch
  group
    atom C   type=C      charge= 0.48 end
    atom O   type=O      charge=-0.48 end

  group
    atom SD  type=S   charge= 0.00 end
 
    atom C11  type=CJ8     charge=-0.20   end
    atom H111 type=HJ38    charge=0.10    end
    atom H112 type=HJ39    charge=0.10    end
 
    atom C12  type=CJ8     charge=-0.20   end
    atom H121 type=HJ38    charge=0.10    end
    atom H122 type=HJ39    charge=0.10    end
 
    atom N13  type=NJ7     charge=-0.36   end
    atom H13  type=HJ37    charge=0.26    end
 
    ! For conjugated-EDTA part
    !
    ! Numbering of atoms are according to:
    !    Richards et al. (1964) Inorg. Chem. 3, 27-33.
    ! 
    ! Chelating atoms: OY2, OY3, OY4, NYA, NYB
    !

    !acetate branch1 (attached on linker)
 
    atom CY5  type=CJ11    charge=0.48    end ! ASN charge
    atom OY1  type=MO1     charge=-0.48   end ! ASN charge
    atom CY1  type=CJ13    charge=-0.20   end ! ASN charge
    atom HY11 type=HJ43    charge=0.10    end ! ASN charge
    atom HY12 type=HJ44    charge=0.10    end ! ASN charge

    !ethylenediamine backbone 
 
    atom NYA  type=NYA    charge=-0.60   end ! Check charge!
    atom CYA  type=CJ15    charge=-0.20   end ! Check charge!
    atom HYA1 type=HJ45    charge=0.10    end ! Check charge!
    atom HYA2 type=HJ46    charge=0.10    end ! Check charge!
    atom CYB  type=CJ15    charge=-0.20   end ! Check charge!
    atom HYB1 type=HJ45    charge=0.10    end ! Check charge!
    atom HYB2 type=HJ46    charge=0.10    end ! Check charge!
    atom NYB  type=NYB    charge=-0.60   end ! Check charge!

    !acetate branch 3
 
    atom CY3  type=CJ17    charge=-0.45   end ! ASP charge 
    atom HY31 type=HJ49    charge=0.10    end ! ASP charge
    atom HY32 type=HJ50    charge=0.10    end ! ASP charge
    atom CY7  type=CJ19    charge=0.49    end ! ASP charge
    atom OY7  type=OJ20    charge=-0.62   end ! ASP charge
    atom OY3  type=MO3     charge=-0.62   end ! ASP charge

    !acetate branch 2
 
    atom CY2  type=CJ18    charge=-0.45   end ! ASP charge
    atom HY21 type=HJ49    charge=0.10    end ! ASP charge
    atom HY22 type=HJ50    charge=0.10    end ! ASP charge
    atom CY6  type=CJ19    charge=0.49    end ! ASP charge
    atom OY6  type=OJ20    charge=-0.62   end ! ASP charge
    atom OY2  type=MO2     charge=-0.62   end ! ASP charge

    !acetate branch 4
 
    atom CY4  type=CJ18    charge=-0.45   end ! ASP charge
    atom HY41 type=HJ49    charge=0.10    end ! ASP charge
    atom HY42 type=HJ50    charge=0.10    end ! ASP charge
    atom CY8  type=CJ19    charge=0.49    end ! ASP charge
    atom OY8  type=OJ20    charge=-0.62   end ! ASP charge
    atom OY4  type=MO4     charge=-0.62   end ! ASP charge

    !manganese(II) ion
 
    atom MN   type=MN      charge=2.0      end  


!Bonds:  
!cys
  bond N  HN
  bond N  CA     bond CA HA
  bond CA C
  bond C  O
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB SG     

!linker
 BOND  SG  SD
 BOND  SD  C11       BOND  C11  C12
 BOND  C11 H111      BOND  C11 H112      BOND  C12  N13      BOND  C12 H121
 BOND  C12 H122      BOND  N13  CY5      BOND  N13  H13      BOND  CY5  OY1
 BOND  CY5  CY1      BOND  CY1  NYA      BOND  CY1 HY11      BOND  CY1 HY12
 BOND  NYA  CYA      BOND  NYA  CY4      BOND  CYA  CYB      BOND  CYA HYA1
 BOND  CYA HYA2      BOND  CYB  NYB      BOND  CYB HYB1      BOND  CYB HYB2
 BOND  NYB  CY3      BOND  NYB  CY2      BOND  CY3  CY7      BOND  CY3 HY31
 BOND  CY3 HY32      BOND  CY7  OY7      BOND  CY7  OY3      BOND  CY2  CY6
 BOND  CY2 HY21      BOND  CY2 HY22      BOND  CY6  OY6      BOND  CY6  OY2
 BOND  CY4  CY8      BOND  CY4 HY41      BOND  CY4 HY42      BOND  CY8  OY8
 BOND  CY8  OY4

!manganese
  bond  MN NYA        bond MN NYB
  bond  MN OY1        bond  MN OY2        bond MN OY3         bond MN OY4

 !DIHE_ dihe  N    CA   CB   SG
 !DIHE_ dihe  CA   CB   SG   SD
 !DIHE_ dihe  CB   SG   SD   C11
 !DIHE_ dihe  SG   SD   C11  C12 ! 
 !DIHE_ dihe  SD   C11  C12  N13 ! 
 !DIHE_ dihe  C11  C12  N13  CY5 ! 
 !DIHE_ dihe  N13  CY5  CY1  NYA ! 

!this set of dihedrals changed to impropers s.t. the geomtry is defined
! CDS 2009/01/07

 improper  CY5  CY1  NYA  CYA ! 
 improper  CY5  CY1  NYA  CY4 ! CHECK!
 improper  CY1  NYA  CYA  CYB ! CHECK!
 improper  CY4  NYA  CYA  CYB ! CHECK!
 improper  CYA  NYA  CY4  CY8 ! CHECK!
 improper  NYA  CYA  CYB  NYB ! 
 improper  CYA  CYB  NYB  CY3 ! CHECK!
 improper  CYA  CYB  NYB  CY2 ! CHECK!
 improper  CY2  NYB  CY3  CY7 ! CHECK!
 improper  CY3  NYB  CY2  CY6 ! CHECK!
 improper  NYB  CY3  CY7  OY3 ! 
 improper  NYB  CY2  CY6  OY2 ! 
 improper  NYA  CY4  CY8  OY4 ! 
 improper  NYA  CY1  CY5  OY1 ! 
{
! hydrogens
 !DIHE_ dihe  SG   SD   C11 H111  
 !DIHE_ dihe  SG   SD   C11 H112   
 !DIHE_ dihe  SD   C11  C12 H121  
 !DIHE_ dihe  SD   C11  C12 H122   
 !DIHE_ dihe  HY11  CY1  NYA  CYA  
 !DIHE_ dihe  HY12  CY1  NYA  CYA  
 !DIHE_ dihe  HY41  CY4  NYA  CYA
 !DIHE_ dihe  HY42  CY4  NYA  CYA
 !DIHE_ dihe  HY21  CY2  NYB  CYB
 !DIHE_ dihe  HY22  CY2  NYB  CYB
 !DIHE_ dihe  HY31  CY3  NYB  CYB
 !DIHE_ dihe  HY32  CY3  NYB  CYB
}
 improper  HA   N    C   CB
 improper  HB1  HB2  CA  SG
 improper  C11  SD   C12 H111 ! chirality                   
 improper  C11  SD   C12 H112 ! chirality                    
 improper  C12  C11  N13 H121 ! chirality                   
 improper  C12  C11  N13 H122 ! chirality                   
 improper  N13  C12  CY5  H13 ! flatness of amide          
 improper  CY5  N13  OY1  CY1 ! flatness of carbonyl       
 improper  C12  N13  CY5  CY1 ! flatness of peptide bond
 improper  CY1  CY5  NYA HY11 ! chirality                   
 improper  CY1  CY5  NYA HY12 ! chirality                    
 improper  NYA  CY1  CYA  CY4 ! chirality CHECK!!!          
 improper  CYA  NYA  CYB HYA1 ! chirality                   
 improper  CYA  NYA  CYB HYA2 ! chirality                    
 improper  CYB  CYA  NYB HYB1 ! chirality                   
 improper  CYB  CYA  NYB HYB2 ! chirality                    
 improper  NYB  CYB  CY3  CY2 ! chirality CHECK!!!           
 improper  CY3  NYB  CY7 HY31 ! chirality                   
 improper  CY3  NYB  CY7 HY32 ! chirality                    
 improper  CY7  CY3  OY7  OY3 ! flatness of carboxyl group   
 improper  CY2  NYB  CY6 HY21 ! chirality                   
 improper  CY2  NYB  CY6 HY22 ! chirality                    
 improper  CY6  CY2  OY6  OY2 ! flatness of carboxyl group   
 improper  CY4  NYA  CY8 HY41 ! chirality                   
 improper  CY4  NYA  CY8 HY42 ! chirality                    
 improper  CY8  CY4  OY8  OY4 ! flatness of carboxyl group   

 improper SD  C12 H111 H112 ! C11 chirality  ! NO EQUIVALENT IN NUCLEIC RESIDUE TED
 improper C11 N13 H121 H122 ! C12 chirality  ! NOT IN NUCLEIC RESIDUE TED

 improper CY1  MN  CYA CY4    ! NYA chirality
 improper CY2  MN  CYB CY3    ! NYB chirality

 improper OY3 OY4 NYB NYA !  metal center chirality cds 20090105
 improper OY1 OY2 NYA NYB !  
 improper OY3 OY2 NYB NYA
 improper OY1 OY4 NYA NYB


 ACCE  OY1  CY5
 ACCE  OY2  CY6
 ACCE  OY3  CY7
 ACCE  OY4  CY8
 ACCE  OY6  CY6
 ACCE  OY7  CY7
 ACCE  OY8  CY8

  DONO HN   N
  ACCE O    C

end 

!----------------------------------------------------------------------

! RESIDUE LYR (modified Lysine with retinoic acid, protonated schiff base)
!   structure from:   	Hamanaka et al (1972) Acta Cryst B28:214.
!   charges from:	Hayashi & Ohmine (2000) J. Phys. Chem. B 104:10678.
!       		Hayashi et al (2001) J. Phys. Chem. B 105:10124.
!   bonds/angles from:	Nina et al. (1995) Biophys. J. 68:25.
! 			Baudry et al. (1997) J. Chem. Info. Comput. Sci. 37:1018. 
!			Tajkhorshid et al (1997) J. Phys. Chem. B 101:8021.
! 			Tajkhorshid et al (1999) J. Phys. Chem. B 103:5581.
! 			Tajkhorshid et al (2000) Biophys. J. 78:683.
! FMM added 7/25/16
! 
! WARNING: No impropers to enforce planarity accross double bonds. (GAB 29-MAR-2018)
!

 MASS HCR    1.0080 ! HN polyene Schiff base
 MASS CA1   12.0110 ! Schiff base alkene conjugation
 MASS NCH1  14.0070 ! protonated nitrogen Schiff base

residue LYR  

  GROUP 
    atom N    type=NH1    charge=-0.470  end !                         
    atom HN   type=H      charge= 0.310  end !                      
  group
    atom CA   type=CH1E   charge= 0.070  end !                  O      HA     HN
    atom HA   type=HA     charge= 0.090  end !                   \\    |      /
  GROUP                                      !                  --C----CA----N---
    atom C    type=C      charge= 0.510  end !                         |
    atom O    type=O      charge=-0.510  end !                         |
  GROUP                                      !                         |
    atom CB   type=CH2E   charge=-0.180  end !                         |
    atom HB1  type=HA     charge= 0.090  end !                     HB2-CB-HB1
    atom HB2  type=HA     charge= 0.090  end !                         |
  GROUP                                      !                         |
    atom CG   type=CH2E   charge=-0.180  end !                         |
    atom HG1  type=HA     charge= 0.090  end !                     HG2-CG-HG1
    atom HG2  type=HA     charge= 0.090  end !                         |
  GROUP                                      !                         |
    atom CD   type=CH2E   charge=-0.180  end !                         |
    atom HD1  type=HA     charge= 0.090  end !                     HD2-CD-HD1
    atom HD2  type=HA     charge= 0.090  end !                         |
  GROUP                                      !                         |
    atom CE   type=CH2E   charge= 0.340  end !                         |
    atom HE1  type=HA     charge= 0.050  end !                     HE2-CE-HE1
    atom HE2  type=HA     charge= 0.050  end !                         |
    atom N16  type=NCH1   charge=-0.727  end !                        +N16--H16 
    atom H16  type=HCR    charge= 0.505  end !                        //
    atom C15  type=CA1    charge= 0.362  end !                  H15--C15
    atom H15  type=HA     charge= 0.189  end !                        \
    atom C14  type=CA1    charge=-0.180  end !                H20B     C14-H14
    atom H14  type=HA     charge= 0.180  end !                 |      //
    atom C13  type=CA1    charge= 0.131  end !           H20A--C20 -- C13
    atom C20  type=CH3E   charge=-0.170  end !                 |      \
    atom H20A type=HA     charge= 0.090  end !                H20C     C12-H12
    atom H20B type=HA     charge= 0.090  end !                        //
    atom H20C type=HA     charge= 0.090  end !                   H11--C11
    atom C12  type=CA1    charge=-0.110  end !                        \
    atom H12  type=HA     charge= 0.110  end !                H19B     C10-H10
    atom C11  type=CA1    charge=-0.090  end !                  |      //
    atom H11  type=HA     charge= 0.090  end !            H19A--C19 -- C9
                                             !                  |      \
  GROUP                                      !                H19C      C8-H8
    atom C10  type=CA1    charge=-0.100  end !                         //
    atom H10  type=HA     charge= 0.100  end !                     H7--C7
                                             !                         |
  GROUP                                      !                         |
    atom C9   type=CA1     charge= 0.00  end !                         |
    atom C19  type=CH3E    charge=-0.27  end !                         |
    atom H19A type=HA      charge= 0.09  end !                         |
    atom H19B type=HA      charge= 0.09  end !                         |
    atom H19C type=HA      charge= 0.09  end !                         |
                                             !                         |
  GROUP                                      !                         |
    atom C8   type=CA1     charge=-0.10  end !                         | 
    atom H8   type=HA      charge= 0.10  end !                         | 
    atom C7   type=CA1     charge=-0.10  end !                         | 
    atom H7   type=HA      charge= 0.10  end !                         |
                                             !                         |    H17A  H17B
  GROUP                                      !             H18B        C6      \ /
    atom C6   type=CA1     charge= 0.00  end !                |      //   \    C17--H17C
                                             !          H18A--C18   //     \   /     
  GROUP                                      !                |  \ //       \ /       
    atom C5   type=CA1     charge= 0.00  end !             H18C   C5         C1 -- C16--H16B
    atom C18  type=CH3E    charge=-0.27  end !                    |          |     / \
    atom H18A type=HA      charge= 0.09  end !                    |          |  H16C  H16A
    atom H18B type=HA      charge= 0.09  end !                    |          |
    atom H18C type=HA      charge= 0.09  end !               H4A--C4         C2--H2A
                                             !                   / \        / \
  GROUP                                      !                 H4B  \      /   H2B
    atom C4   type=CH2E    charge=-0.20  end !                       \    /
    atom H4A  type=HA      charge= 0.10  end !                         C3
    atom H4B  type=HA      charge= 0.10  end !                        /  \
                                             !                       H3A    H3B
  GROUP
    atom C3   type=CH2E    charge=-0.20  end !
    atom H3A  type=HA      charge= 0.10  end !
    atom H3B  type=HA      charge= 0.10  end !
  
  GROUP
    atom C2   type=CH2E    charge=-0.20  end !
    atom H2A  type=HA      charge= 0.10  end !
    atom H2B  type=HA      charge= 0.10  end !
  
  GROUP
    atom C1   type=CH2E    charge= 0.00  end ! CH1E?! CHECK TYPE
    atom C16  type=CH3E    charge=-0.27  end !
    atom H16A type=HA      charge= 0.09  end !
    atom H16B type=HA      charge= 0.09  end !
    atom H16C type=HA      charge= 0.09  end !
  
  GROUP
    atom C17  type=CH3E    charge=-0.27  end !
    atom H17A type=HA      charge= 0.09  end !
    atom H17B type=HA      charge= 0.09  end !
    atom H17C type=HA      charge= 0.09  end !

  BOND N   HN    
  BOND N   CA     BOND CA  HA  
  BOND CA  C      BOND C   O
  BOND CA  CB     BOND CB  HB1    BOND CB  HB2
  BOND CB  CG     BOND CG  HG1    BOND CG  HG2
  BOND CG  CD     BOND CD  HD1    BOND CD  HD2
  BOND CD  CE     BOND CE  HE1    BOND CE  HE2
  BOND CE  N16    BOND N16 H16
  BOND N16 C15    BOND C15 H15  
  BOND C15 C14    BOND C14 H14
  BOND C14 C13    BOND C13 C20    BOND C20 H20A  BOND C20 H20B   BOND C20 H20C
  BOND C13 C12    BOND C12 H12                                           
  BOND C12 C11    BOND C11 H11
  BOND C11 C10    BOND C10 H10
  BOND C10 C9     BOND C9  C19    BOND C19 H19A  BOND C19 H19B   BOND C19 H19C
  BOND C9  C8     BOND C8  H8
  BOND C8  C7     BOND C7  H7
  BOND C7  C6     BOND C6  C5
  BOND C5  C18    BOND C18 H18A   BOND C18 H18B  BOND C18 H18C
  BOND C5  C4     BOND C4  H4A    BOND C4  H4B
  BOND C4  C3     BOND C3  H3A    BOND C3  H3B
  BOND C3  C2     BOND C2  H2A    BOND C2  H2B
  BOND C2  C1     BOND C1  C6
  BOND C1  C16    BOND C16 H16A   BOND C16 H16B     BOND C16 H16C
  BOND C1  C17    BOND C17 H17A   BOND C17 H17B     BOND C17 H17C

! LYS moiety geometry
  improper HA   N    C    CB     !stereo CA 
  improper HB1  HB2  CA   CG     !stereo CB 
  improper HG1  HG2  CB   CD     !stereo CG 
  improper HD1  HD2  CG   CE     !stereo CD 

  improper HE1  HE2  CD   N16    !stereo CE 

! Retinal chain sp2 hybridization planarity. 
  improper N16  CE   C15  H16    !TYPE:  NCH1  CT    CA1   HCR   (0.00)
  improper C15  N16  C14  H15    !TYPE:  CA1   NCH1  CA1   HA    (0.00)
  improper C14  C13  C15  H14    !TYPE:  CA1   CA1   CA1   HA    (0.00)
  improper C13  C14  C12  C20    !TYPE:  CA1   CA1   CA1   CT    (0.00)
  improper C12  C11  C13  H12    !TYPE:  CA1   CA1   CA1   HA    (0.00)
  improper C11  C12  C10  H11    !TYPE:  CA1   CA1   CA1   HA    (0.00)
  improper C10  C9   C11  H10    !TYPE:  CA1   CA1   CA1   HA    (0.00)
  improper C9   C10  C8   C19    !TYPE:  CA1   CA1   CA1   CT    (0.00)
  improper C8   C7   C9   H8     !TYPE:  CA1   CA1   CA1   HA    (0.00)
  improper C7   C8   C6   H7     !TYPE:  CA1   CA1   CA1   HA    (0.00)

! Retinal ring  planarity
  improper C6   C1   C5   C7   	!TYPE:  CA1   CT    CA1   CA1   (0.00) 
  improper C5   C6   C4   C18  	!TYPE:  CA1   CA1   CT    CT    (0.00) 
  improper C5   C6   C1   C2   	!TYPE:  CA1   CA1   CT    CT    (0.00) 
  improper C7   H7   C5   C1   	!TYPE:  CA1   HA    CA1   CT    (0.00) 


! LYS moiety dihedrals converted to impropers to allow use of torsionDB without DIHE
!!  improper N    CA   CB   CG  	!TYPE:  NH1   CT    CT    CT    (chi1)
!!  improper CA   CB   CG   CD 	!TYPE:  CT    CT    CT    CT    (chi2)
!!  improper CB   CG   CD   CE  	!TYPE:  CT    CT    CT    CT    (chi3)
!!  improper CG   CD   CE   N16 	!TYPE:  CT    CT    CT    NCH1  (chi4)
!!  improper CD   CE   N16  C15 	!TYPE:  CT    CT    NCH1  CA1   (-90)


  ! LYS moiety dihedrals (same as LYS). 
  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral CD  CG  CB  CA
  !DIHE_ dihedral CE  CD  CG  CB
  !DIHE_ dihedral N16 CE  CD  CG
  
  !DIHE_ dihedral CD   CE   N16  C15 


  DONO HN   N
  DONO H16  N16
  ACCE O    C
  
end



!----------------------------------------------------------------------

! 
! Slightly modified version of AIB topology posted by Justin T. Douglas 
! to the Xplor-NIH mailing list 2016/03/17.
!
! CDS 2016/11/21
! 

residue AIB ! alpha-aminoisobutyric residue
 group
   atom N    type=NH1  charge=-0.36 end
   atom HN   type=H    charge= 0.26 end
  group
   atom CA   type=CH1E charge= 0.00 end  ! no "CH0E" type (GAB 29-MAR-2018)
  group
   atom CB1  type=CH3E charge=-0.30 end
   atom HB11 type=HA   charge= 0.10 end
   atom HB12 type=HA   charge= 0.10 end
   atom HB13 type=HA   charge= 0.10 end
  group
   atom CB2  type=CH3E charge=-0.30 end
   atom HB21 type=HA   charge= 0.10 end
   atom HB22 type=HA   charge= 0.10 end
   atom HB23 type=HA   charge= 0.10 end
  group
   atom C    type=C    charge= 0.48 end
   atom O    type=O    charge=-0.48 end

 bond N HN
 bond N CA
 bond CA CB1 bond CB1 HB11 bond CB1 HB12 bond CB1 HB13
 bond CA CB2 bond CB2 HB21 bond CB2 HB22 bond CB2 HB23
 bond CA C
 bond C O

 improper CB2 N C CB1    !chirality CA (GAB 29-MAR-2018)

 improper HB11 HB12 CA HB13 !stereo CB1
 improper HB21 HB22 CA HB23 !stereo CB2
 
 !DIHE_ dihedral HB11 CB1  CA  C  ! methyl stagger as ALA  (GAB 29-MAR-2018)
 !DIHE_ dihedral HB21 CB2  CA  C  ! methyl stagger as ALA  (GAB 29-MAR-2018)

end


!----------------------------------------------------------------------

{ *** MISSING PARAMETERS! - GAB 18-APR-2018 

residue CHX  !! ADDED BY MN
  group
    atom N   type=NH1 charge=-0.360 end
    atom HN  type=H   charge= 0.260 end
  group
    atom CA  type=CH1E  charge= 0.000 end
    atom HA  type=HA  charge= 0.100 end
  group
    atom CB  type=CH2E  charge=-0.200 end
    atom HB1 type=HA  charge= 0.100 end
    atom HB2 type=HA  charge= 0.100 end
  group
    atom CG  type=CH1E  charge=-0.200 end
    atom HG  type=HA  charge= 0.100 end
  group
    atom CD1  type=CH2E  charge=-0.200 end
    atom HD11 type=HA  charge= 0.100 end
    atom HD12 type=HA  charge= 0.100 end
  group
    atom CD2  type=CH2E  charge=-0.200 end
    atom HD21 type=HA  charge= 0.100 end
    atom HD22 type=HA  charge= 0.100 end
  group
    atom CE1  type=CH2E  charge=-0.200 end
    atom HE11 type=HA  charge= 0.100 end
    atom HE12 type=HA  charge= 0.100 end
  group
    atom CE2  type=CH2E  charge=-0.200 end
    atom HE21 type=HA  charge= 0.100 end
    atom HE22 type=HA  charge= 0.100 end
  group
    atom CZ  type=CH2E  charge=-0.200 end
    atom HZ1 type=HA  charge= 0.100 end
    atom HZ2 type=HA  charge= 0.100 end
  group
    atom C   type=C   charge= 0.480 end
    atom O   type=O   charge=-0.480 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG     bond CG CD1     bond CG CD2     bond CG HG    
  bond CD1 CE1   bond CD1 HD11    bond CD1 HD12   
  bond CD2 CE2   bond CD2 HD21    bond CD2 HD22
  bond CE1 CZ    bond CE1 HE11    bond CE1 HE12
  bond CE2 CZ    bond CE2 HE21    bond CE2 HE22
  bond CZ HZ1    bond CZ  HZ2
  bond CA C
  bond C  O

  improper HA N C CB          !chirality CA
  improper HB1 HB2 CA CG  !stereo CB
  improper HG CB CD1 CD2      !stereo CG
  improper HD11 HD12 CG CE1      !stereo CD1
  improper HD21 HD22 CG CE2      !stereo CD2
  improper HE11 HE12 CE1 CZ      !stereo CE1
  improper HE11 HE22 CE2 CZ      !stereo CE2
  improper HZ1 HZ2 CE1 CE2  !stereo CZ

  !DIHE_ dihedral CG  CB  CA  N
  !DIHE_ dihedral CD1  CG  CB  CA

  DONO HN   N
  ACCE O    C
end

********** }


!----------------------------------------------------------------------

residue ACE
  group
    atom CA  type=CH3E charge= 0.000 end
    atom HA1 type=HA charge= 0.000 end
    atom HA2 type=HA charge= 0.000 end
    atom HA3 type=HA charge= 0.000 end
  group
    atom C   type=C  charge= 0.500 end
    atom O   type=O  charge=-0.500 end

  bond C  CA     bond CA HA1     bond CA HA2     bond CA HA3
  bond C  O

  improper HA1 HA2 C HA3  !methyl CA

  ACCE O    C
end


!----------------------------------------------------------------------

presidue NTER                      ! patch as "NTER + *" to any except PRO
    modify    atom +CA           charge= 0.310 end
  group
    modify    atom +N   type=NH3 charge=-0.300 end
    delete    atom +HN                        end
    add       atom +HT1 type=HC  charge= 0.330 end
    add       atom +HT2 type=HC  charge= 0.330 end
    add       atom +HT3 type=HC  charge= 0.330 end

  add bond +HT1 +N
  add bond +HT2 +N
  add bond +HT3 +N

  add angle +HT1 +N +HT2
  add angle +HT2 +N +HT3
  add angle +HT2 +N +CA
  add angle +HT1 +N +HT3
  add angle +HT1 +N +CA
  add angle +HT3 +N +CA
  add improper +HT1 +HT2 +CA +HT3  !methyl N ???

  !DIHE_ add dihedral +C  +CA  +N  +HT1      ! UCL (12-MAR-00)

  ADD DONOr +HT1  +N
  ADD DONOr +HT2  +N
  ADD DONOr +HT3  +N
end

!----------------------------------------------------------------------

presidue PROP                        ! N-terminal for PRO/HYP: "PROP - PRO/HYP"
! the charges are guessed from making the residue have charge +1
! and keeping the same charge on N as in NTER (Michael Nilges)
  modify    atom +CD           charge= 0.320 end
  modify    atom +CA           charge= 0.320 end
group
  modify    atom +N   type=NP3 charge=-0.300 end
  add       atom +HT1 type=HC  charge= 0.330 end
  add       atom +HT2 type=HC  charge= 0.330 end

  add bond +HT1 +N
  add bond +HT2 +N

  add angle +HT1 +N +HT2
  add angle +HT2 +N +CA
  add angle +HT1 +N +CD
  add angle +HT1 +N +CA
  add angle +CD  +N +HT2
  add improper +HT1 +HT2 +CA +CD  !stereo N 
 
  ADD DONOr +HT1  +N
  ADD DONOr +HT2  +N
end
 
!----------------------------------------------------------------------

presidue CTER               ! C-terminal for all amino acids "* - CTER"
                            ! 2023/10/18 CDS - oxygen atoms' names fixed
! charge on -C changed from 0.700 to make group -1, Michael Nilges
    modify    atom -CA            charge= 0.100  end
  group
    modify    atom -C             charge= 0.700  end
    delete    atom -O                            end
    add       atom -OT1 type=OC   charge=-0.800  end
    add       atom -OT2 type=OC   charge=-0.800  end

  add bond -C -OT1
  add bond -C -OT2

  add angle -CA  -C -OT1
  add angle -CA  -C -OT2
  add angle -OT1 -C -OT2

  add improper -C -CA -OT2 -OT1
 
  !DIHE_ add dihedral -N -CA -C -O      ! UCL (12-MAR-00)

  ADD ACCEptor -OT1 -C
  ADD ACCEptor -OT2 -C
end


!----------------------------------------------------------------------

presidue CTN                  ! C-terminal for all, CONH2 at end "* - CTN"
! charges not consistent with rest, Michael Nilges
  group
    modify    atom -C           charge= 0.48 end
    modify    atom -O           charge=-0.48 end
    add       atom -NT type=NH2 charge=-0.52 end
    add       atom -H1 type=H   charge= 0.26 end
    add       atom -H2 type=H   charge= 0.26 end

  add bond -C  -NT
  add bond -NT -H1
  add bond -NT -H2

  add angle -CA -C  -NT
  add angle -O  -C  -NT
  add angle -CA -C  -O
  add angle -C  -NT -H1
  add angle -C  -NT -H2
  add angle -H1 -NT -H2

  add improper -C  -CA -NT -O
  add improper -C  -NT -O  -H1
  add improper -NT -H1 -H2 -C

  !DIHE_ add dihedral -N -CA -C -NT      ! UCL (12-MAR-00)

  ADD DONOR  -H1 -NT
  ADD DONOR  -H2 -NT
end

!----------------------------------------------------------------------


presidue PEPT     ! PEPTide bond link, for all except the  *(-) - (+)PRO link
                  ! "*(-) - PEPT - (+)*:
  add bond -C +N

  add angle -CA -C +N
  add angle -O  -C +N
  add angle -C  +N +CA
  add angle -C  +N +HN

  add improper  -C -CA +N -O                 ! planar -C
  add improper  +N -C +CA +HN                ! planar +N
  add improper -CA -C  +N  +CA               ! angle across peptide plane

! phi/psi related topology UCL 05-JUL-01

  !DIHE_ add dihedral  -C +N +CA +C  mult 6
  !DIHE_ add dihedral  -C +N +CA +CB mult 6
  !DIHE_ add dihedral  -CB -CA -C +N mult 6
  !DIHE_ add dihedral  -CB -CA -C -O mult 6         ! corrected from +O 16-Sept-02
end
 
!----------------------------------------------------------------------

presidue DPEP     ! delete PEPTide bond link, for all except the  *(-) - (+)PRO link
                  ! "*(-) - PEPT - (+)*:, ATB 07/10/10
                  ! This will also work for peptide links involving GLY except that
                  ! harmless error messages will be produced about not finding certain dihedrals.
  delete bond -C +N

  delete angle -CA -C +N
  delete angle -O  -C +N
  delete angle -C  +N +CA
  delete angle -C  +N +HN

  delete improper  -C -CA +N -O                 ! planar -C
  delete improper  +N -C +CA +HN                ! planar +N
  delete improper -CA -C  +N  +CA               ! angle across peptide plane

! phi/psi related topology UCL 05-JUL-01

  !DIHE_ delete dihedral  -C +N +CA +C  mult 6
  !DIHE_ delete dihedral  -C +N +CA +CB mult 6
  !DIHE_ delete dihedral  -CB -CA -C +N mult 6
  !DIHE_ delete dihedral  -CB -CA -C -O mult 6         ! corrected from +O 16-Sept-02
end

!----------------------------------------------------------------------

presidue PEPP     ! for  ...*(-) - (+)PRO  link, same as PEPT except
                  ! replacement H by CD and improper +N +CA +CD -C
  add bond -C +N

  add angle -CA -C +N
  add angle -O  -C +N
  add angle -C  +N +CA
  add angle -C  +N +CD

!  !DIHE_ ADD DIHEdral  -C +N +CA +C  ! taken out since related to phi MN 18-MAR-02
!  !DIHE_ ADD DIHEdral  -N -CA -C +N  ! taken out since equivalent below MN 18-MAR-02
!  !DIHE_ ADD DIHEdral  -CA -C +N +CA ! taken out since improper below MN 18-MAR-02

  add improper  -C  -CA +N  -O               ! planar -C
  add improper  +N  -C +CA +CD               ! planar +N
  add improper -CA  -C  +N  +CA              ! angle across peptide plane

! psi related topology N.B. phi is fixed by ring bonding 05-JUL-01

  !DIHE_ add dihedral  -CB -CA -C +N mult 6
  !DIHE_ add dihedral  -CB -CA -C -O mult 6         ! corrected from +O 16-Sept-02
end

!----------------------------------------------------------------------

presidue DPPP     ! delete peptide bond link for  ...*(-) - (+)PRO  link, same as PEPT except
                  ! replacement H by CD and improper +N +CA +CD -C, ATB 07/10/10
                  ! This will also work for peptide links involving GLY except that
                  ! harmless error messages will be produced about not finding certain dihedrals.
  delete bond -C +N

  delete angle -CA -C +N
  delete angle -O  -C +N
  delete angle -C  +N +CA
  delete angle -C  +N +CD

!  !DIHE_ DELETE DIHEdral  -C +N +CA +C  ! taken out since related to phi MN 18-MAR-02
!  !DIHE_ DELETE DIHEdral  -N -CA -C +N  ! taken out since equivalent below MN 18-MAR-02
!  !DIHE_ DELETE DIHEdral  -CA -C +N +CA ! taken out since improper below MN 18-MAR-02

  delete improper  -C  -CA +N  -O               ! planar -C
  delete improper  +N  -C +CA +CD               ! planar +N
  delete improper -CA  -C  +N  +CA              ! angle across peptide plane

! psi related topology N.B. phi is fixed by ring bonding 05-JUL-01

  !DIHE_ delete dihedral  -CB -CA -C +N mult 6
  !DIHE_ delete dihedral  -CB -CA -C -O mult 6         ! corrected from +O 16-Sept-02
end

!----------------------------------------------------------------------

presidue PPGP     ! for  GLY(-) - (+)PRO  link, same as PEPT except
                  ! replacement H by CD and improper +N +CA +CD -C
  add bond -C +N

  add angle -CA -C +N
  add angle -O  -C +N
  add angle -C  +N +CA
  add angle -C  +N +CD

!  !DIHE_ ADD DIHEdral  -C +N +CA +C  ! taken out since related to phi MN 18-MAR-02
!  !DIHE_ ADD DIHEdral  -N -CA -C +N  ! taken out since equivalent below MN 18-MAR-02
!  !DIHE_ ADD DIHEdral  -CA -C +N +CA ! taken out since improper below MN 18-MAR-02

  add improper  -C  -CA +N  -O               ! planar -C
  add improper  +N  -C +CA +CD               ! planar +N
  add improper -CA  -C  +N  +CA              ! angle across peptide plane

end

!----------------------------------------------------------------------

PRESidue PPGG { for GLY (-) - (+) GLY LINK }

  add bond -C +N

  add angle -CA -C +N
  add angle -O  -C +N
  add angle -C  +N +CA
  add angle -C  +N +HN

  add improper  -C -CA +N -O                 ! planar -C
  add improper  +N -C +CA +HN                ! planar +N
  add improper -CA -C  +N  +CA               ! angle across peptide plane

! phi/psi related topology UCL 05-JUL-01

  !DIHE_ add dihedral  -C +N +CA +C  mult 6
end

!----------------------------------------------------------------------

PRESidue PPG1 { for ...*(-) - (+) GLY LINK }

  add bond -C +N

  add angle -CA -C +N
  add angle -O  -C +N
  add angle -C  +N +CA
  add angle -C  +N +HN

  add improper  -C -CA +N -O                 ! planar -C
  add improper  +N -C +CA +HN                ! planar +N
  add improper -CA -C  +N  +CA               ! angle across peptide plane

! phi/psi related topology UCL 05-JUL-01

  !DIHE_ add dihedral  -C +N +CA +C  mult 6
  !DIHE_ add dihedral  -CB -CA -C +N mult 6
  !DIHE_ add dihedral  -CB -CA -C -O mult 6          ! corrected from +O 16-Sept-02

end

!----------------------------------------------------------------------

PRESidue PPG2 { for ... GLY(-) - (+) * LINK }
  add bond -C +N

  add angle -CA -C +N
  add angle -O  -C +N
  add angle -C  +N +CA
  add angle -C  +N +HN

  add improper  -C -CA +N -O                  ! planar -C
  add improper  +N -C +CA +HN                 ! planar +N
  add improper -CA -C  +N  +CA                ! angle across peptide plane

! phi/psi related topology UCL 05-JUL-01

  !DIHE_ add dihedral  -C +N +CA +C  mult 6
  !DIHE_ add dihedral  -C +N +CA +CB mult 6
end

!----------------------------------------------------------------------

PRESidue PACE { for ... ACE(-) - (+) * LINK }

  add bond -C +N

  add angle -CA -C +N
  add angle -O  -C +N
  add angle -C  +N +CA
  add angle -C  +N +HN

  add improper  -C -CA +N -O                  ! planar -C
  add improper  +N -C +CA +HN                 ! planar +N
  add improper -CA -C  +N  +CA                ! angle across peptide plane

 ! No dihedrals

end


!----------------------------------------------------------------------

presidue DISU                ! disulfide bridge  ...CYS - DISU - CYS...
  group
    delete    atom 1HG               end
    modify    atom 1CB              charge= 0.300 end
    MODIfy    atom 1SG  type=S      charge=-0.300 end
  group
    delete    atom 2HG               end
    modify    atom 2CB              charge= 0.300 end
    MODIfy    atom 2SG  type=S      charge=-0.300 end

  add bond 1SG 2SG

  add angle 1CB 1SG 2SG
  add angle 1SG 2SG 2CB

  !DIHE_ add dihedral 1CB 1SG 2SG 2CB mult 6   ! UCL modified 12-MAR-00 & 07-JUL-01
end

!----------------------------------------------------------------------

presidue DISN                ! disulfide bridge  ...CYS - DISU - CYS...
                             ! w/o the actual bond
  group
    delete    atom 1HG               end
    modify    atom 1CB              charge= 0.300 end
    MODIfy    atom 1SG  type=S      charge=-0.300 end
  group
    delete    atom 2HG               end
    modify    atom 2CB              charge= 0.300 end
    MODIfy    atom 2SG  type=S      charge=-0.300 end
end

!----------------------------------------------------------------------

presidue CYNH                ! deprotonated CYS

  group
    delete    atom 1HG               end
    modify    atom 1CB              charge= 0.000 end
    MODIfy    atom 1SG  type=S      charge=-0.500 end
end

!----------------------------------------------------------------------

presidue LTOD                        ! change from L to D amino acid
  delete improper HA N C CB
  add    improper HA C N CB
end

!----------------------------------------------------------------------

presidue CISP                        ! change from trans to cis peptide bond
                                     ! Usage: REFErence=NIL=<selection>
  modify atom C type=CCIS end
end

!----------------------------------------------------------------------

presidue CIPP                        ! change from trans to cis peptide bond. not necessary to have separate patch
  modify atom C type=CCIS end
end

! patch to turn serine into phosphoserine
! This one includes the phosphate group
! CDS 2020/11/16
!
presidue SPA
     group
     modify atom 1cb  charge=0.0 end   
     modify atom 1og  type=OHP charge=0.0 end 
     delete atom 1hg  charge=0.0 end
     group
     add atom 1P    type=PP  charge=0.0 end   !charges are bogus
     add atom 1O1P  type=OPT charge=0.0 end
     add atom 1O2P  type=OPT charge=0.0 end
     add atom 1O3P  type=OPT charge=0.0 end 
   add bond 1og 1P
   add bond 1O1P 1P
   add bond 1O2P 1P
   add bond 1O3P 1P
   add angle 1cb 1og 1p
   add angle 1og   1P 1O1P 
   add angle 1og   1P 1O2P
   add angle 1og   1P 1O3P 
   add angle 1O1P  1P 1O2P
   add angle 1O1P  1P 1O3P
   add angle 1O2P  1P 1O3P
end

! patch to turn tyrosine into phosphotyrosine TYR --> PTR
! This one includes the phosphate group
! CDS 2020/11/20
!
presidue PPTR
     group
     modify atom 1cz charge=0.0 end 
     modify atom 1oh type=OHP charge=0.0 end 
     delete atom 1hh  end
     group
     add atom 1P    type=PP charge=0.0 end   !charges are bogus
     add atom 1O1P  type=OPT charge=0.0 end
     add atom 1O2P  type=OPT charge=0.0 end
     add atom 1O3P  type=OPT charge=0.0 end 
   add bond 1oh 1P
   add angle 1cz 1oh 1p
   add angle 1oh   1P 1O1P 
   add angle 1oh   1P 1O2P
   add angle 1oh   1P 1O3P 
end

! patch to turn threonine into phosphothreonine THR --> TPO
! This one includes the phosphate group
! CDS 2020/11/18
!
presidue PTPO
     group
     modify atom 1cb   charge=0.0 end   
     modify atom 1og1  type=OHP charge=0.0 end 
     delete atom 1hg1  end
     group
     add atom 1P    type=PP  charge=0.0 end   !charges are bogus
     add atom 1O1P  type=OPT charge=0.0 end
     add atom 1O2P  type=OPT charge=0.0 end
     add atom 1O3P  type=OPT charge=0.0 end 

   add bond 1og1 1P
   add bond 1O1P 1P
   add bond 1O2P 1P
   add bond 1O3P 1P
   add angle 1cb 1og1 1p
   add angle 1og1   1P 1O1P 
   add angle 1og1   1P 1O2P
   add angle 1og1   1P 1O3P 
   add angle 1O1P  1P 1O2P
   add angle 1O1P  1P 1O3P
   add angle 1O2P  1P 1O3P
end


!--------------------------------------------------------------------------

PRESidue HISE   ! Patch to change doubly protonated HIS to singly protonated histidine (HE2)
                ! has to be patched as REFErence=NIL=<selection>
!  DELETE DONOR  ND1 HD1 ! for some reason it complains it doesn't find the donor - GAB, 28-APR-2017
  MODIFY atom  CB   type=CH2E    CHARge= 0.000  END
  MODIFY atom  CG   type=C5      CHARge= 0.130  END !#
  MODIFY atom  ND1  type=NR      CHARge=-0.570  END !#
  MODIFY atom  CE1  type=CRH     CHARge= 0.410  END !#
  MODIFY atom  CD2  type=CR1E    CHARge= 0.100  END
  MODIFY atom  NE2  type=NH1     CHARge=-0.570  END !#
  MODIFY atom  HE2  type=H       CHARge= 0.420  END !#
  DELETE atom  HD1                              END

  ADD ACCEPTOR  ND1 " "
END {HISE}

!--------------------------------------------------------------------------

PRES HISD   ! Patch to change doubly protonated HIS to singly protonated histidine (HD1)
            ! has to be patched as REFErence=NIL=<selection>
!  DELETE DONOR HE2 NE2 ! for some reason it complains it doesn't find the donor - GAB, 28-APR-2017
  MODIFY atom  CB   type=CH2E    CHARge= 0.000  END
  MODIFY atom  CG   type=C5      CHARge= 0.130  END !#
  MODIFY atom  ND1  type=NH1     CHARge=-0.570  END  !#
  MODIFY atom  HD1  type=H       CHARge= 0.420  END  !#
  MODIFY atom  CD2  type=CR1E    CHARge= 0.100  END  !#
  MODIFY atom  NE2  type=NR      CHARge=-0.490  END  !#
  MODIFY atom  CE1  type=CRH     CHARge= 0.410  END  !#
  DELETE atom  HE2                              END

  ADD ACCEPTOR NE2 " "

END {HISD}

!----------------------------------------------------------------------

PRESidue DCA2   ! Patch to add a single bond from an ASP COO- group to a calcium ion

  ADD BOND 1OD1 2CA+2

END

!----------------------------------------------------------------------

PRESidue ECA2   ! Patch to add a single bond from a GLU COO- group to a calcium ion

  ADD BOND 1OE1 2CA+2

END

!----------------------------------------------------------------------

! Patch to link a LYS to a C-terminus (e.g., as in di-ubiquitin) - CDS 2017/10/25
! Usage:
! 	REFErence=1=<selection>
! 	REFErence=2=<selection>
! where the first selection is the C-term and the second is the LYS.

presidue CLYS     
  group
    delete    atom 1OT2               end
    modify    atom 1O   type=O charge=-0.48 end
    modify    atom 1C   type=C charge= 0.48 end
  group
    delete    atom 2HZ2               end
    delete    atom 2HZ3               end
    modify    atom 2NZ   type=NH1 charge=-0.36 end
    modify    atom 2HZ1  type=H   charge= 0.26 end
    modify    atom 2CE   charge=-0.20 end
    modify    atom 2HE1  charge= 0.10 end
    modify    atom 2HE2  charge= 0.10 end

  add bond 1C 2NZ

  add angle 1CA 1C 2NZ
  add angle 1O  1C 2NZ
  add angle 1C  2NZ 2CE
  add angle 1C  2NZ 2HZ1

                                    ! Adapted from PEPT patch - GAB, 19-APR-2018 
  add improper  1C  1CA  2NZ  1O      ! planar -C
  add improper  2NZ  1C  2CE  2HZ1    ! planar +N
  add improper  1CA  1C  2NZ  2CE     ! angle across peptide plane


! Add phi- and psi-like dihedrals?

end

!----------------------------------------------------------------------

! Define standard peptide bonds to generate protein sequence topology  
! by psfGen.seqToPSF.

!LINK PPGP    HEAD - GLY   TAIL + PRO     END  { LINK GLY to PRO }
!LINK PPGP    HEAD - GLY   TAIL + HYP     END  { LINK GLY to HYP }
!LINK PPGG    HEAD - GLY   TAIL + GLY     END  { LINK GLY to GLY }
!LINK PPG1    HEAD - *     TAIL + GLY     END  { LINK to GLY }
!LINK PPG2    HEAD - GLY   TAIL + *       END  { LINK from GLY }
!LINK PACE    HEAD - ACE   TAIL + *       END  { LINK from ACE }


!LINK PEPP    HEAD - *     TAIL + PRO     END  { LINK to PRO }
!LINK PEPP    HEAD - *     TAIL + HYP     END  { LINK to HYP }
!LINK PEPT    HEAD - *     TAIL + *       END

!standard termination
!FIRSt PROP               TAIL + HYP     END { nter for HYP }
!FIRSt PROP               TAIL + PRO     END { nter for PRO }
!FIRSt NTER               TAIL + *       END
!LAST  CTER               HEAD - *       END

!cis-peptide patch specifies one residue (before cis-peptide bond)
!option numCisPeptideResids 1

set message=$prev_messages echo=$prev_echo end


